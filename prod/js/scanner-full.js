/**
 * CSS Scanner Pro - Full Featured Version
 * Complete CSS Scanner with tabs, CodePen export, live editor, and more
 *
 * @author Simon Adjatan
 * @website https://adjatan.org/
 * @github https://github.com/Thecoolsim
 * @X https://x.com/adjatan
 * @facebook https://www.facebook.com/adjatan
 * @license MIT
 */
!function(){"use strict";if(window.__CSS_SCANNER_LOADED__)return;window.__CSS_SCANNER_LOADED__=!0;let n={},t="auto";async function e(t){if("auto"!==t)try{const e=await fetch(chrome.runtime.getURL(`_locales/${t}/messages.json`)),o=await e.json();n=o}catch(e){console.error(`Failed to load translations for ${t}:`,e),n={}}else n={}}const o=(e,o)=>{if("undefined"==typeof chrome||!chrome.i18n)return e;let r;if("auto"!==t&&n[e]){const t=n[e];if(r=t.message||t,o)if(Array.isArray(o)){if(o.forEach((n,t)=>{const e=new RegExp("\\$"+(t+1)+"\\$","g");r=r.replace(e,n)}),t.placeholders)for(const n in t.placeholders){const e=t.placeholders[n].content.match(/\$(\d+)/);if(e){const t=parseInt(e[1])-1;if(t<o.length){const e=new RegExp("\\$"+n.toUpperCase()+"\\$","gi");r=r.replace(e,o[t])}}}}else if(r=r.replace(/\$1\$/g,o),t.placeholders)for(const n in t.placeholders){const t=new RegExp("\\$"+n.toUpperCase()+"\\$","gi");r=r.replace(t,o)}}else r=chrome.i18n.getMessage(e,o)||e;return r},r={active:!1,frozen:!1,currentElement:null,currentTab:"css",displayedCSS:[],displayedHTML:"",sourceFiles:[],liveCSS:"",originalCSS:"",settings:{copyOnClick:!1,pinOnSpace:!0,includeChildren:!1,copyHTMLWithCSS:!1,showGrid:!1,showGuidelines:!1,selectorMode:"smart",maxBreadcrumbDepth:4,language:"auto",ignoreInherited:!1,ignoreVendorPrefixes:!0,ignoreBoxSizing:!1,convertFontSizeToPx:!1,nestPseudoClasses:!1,convertRelativeURLs:!0,includeChildrenHTML:!0},inspectorBlock:null,overlay:null,breadcrumb:null,optionsPanel:null};function i(n,t="smart"){if(!n||n===document.body)return"body";if(n===document.documentElement)return"html";if("smart"===t){if(n.id)return`#${n.id}`;if(n.classList.length>0){const t=Array.from(n.classList)[0];return`${n.tagName.toLowerCase()}.${t}`}const t=n.parentElement;if(t){const e=Array.from(t.children).indexOf(n)+1;return`${n.tagName.toLowerCase()}:nth-child(${e})`}}return n.tagName.toLowerCase()}function a(n,t=!1){const e=window.getComputedStyle(n),o=[];try{for(const t of document.styleSheets)try{s(Array.from(t.cssRules||[]),n,o)}catch(n){}}catch(n){console.error("Error reading stylesheets:",n)}const i=new Set;if(o.forEach(n=>{for(let t=0;t<n.style.length;t++)i.add(n.style[t])}),n.style.length>0)for(let t=0;t<n.style.length;t++)i.add(n.style[t]);const a=Array.from(i).filter(n=>(!r.settings.ignoreVendorPrefixes||!(n.startsWith("-webkit-")||n.startsWith("-moz-")||n.startsWith("-ms-")||n.startsWith("-o-")))&&(!r.settings.ignoreBoxSizing||"box-sizing"!==n)),c=[];return a.forEach(n=>{const t=e.getPropertyValue(n);t&&c.push({prop:n,value:t})}),c}function s(n,t,e){for(const o of n)if(o.style&&o.selectorText)try{const n=o.selectorText.split(",").map(n=>n.trim());for(const r of n)if(t.matches(r)){e.push(o);break}}catch(n){}else o.cssRules&&s(Array.from(o.cssRules),t,e)}function c(n,t){const e=t.trim(),o={position:["static"],float:["none"],clear:["none"],margin:["0px"],"margin-top":["0px"],"margin-right":["0px"],"margin-bottom":["0px"],"margin-left":["0px"],padding:["0px"],"padding-top":["0px"],"padding-right":["0px"],"padding-bottom":["0px"],"padding-left":["0px"],border:["none","0px none","medium none"],"border-top":["none","0px none"],"border-right":["none","0px none"],"border-bottom":["none","0px none"],"border-left":["none","0px none"],"border-radius":["0px"],background:["rgba(0, 0, 0, 0)","transparent","none"],"background-color":["rgba(0, 0, 0, 0)","transparent"],"background-image":["none"],opacity:["1"],"z-index":["auto"],transform:["none"],transition:["all 0s ease 0s","none"],animation:["none"],"box-shadow":["none"],"text-shadow":["none"],overflow:["visible"],"overflow-x":["visible"],"overflow-y":["visible"],visibility:["visible"],cursor:["auto"],"pointer-events":["auto"]};return o[n]?o[n].includes(e):!!/^0(px|em|rem|%)?$/.test(e)}function l(n){const t=new Map,e=[];n.forEach(({prop:n,value:e})=>{t.set(n,e)});const o=new Set;function r(...n){return n.every(t=>t===n[0])}function i(n){const[t,e,o,i]=n;return r(t,e,o,i)?t:t===o&&e===i?`${t} ${e}`:e===i?`${t} ${e} ${o}`:`${t} ${e} ${o} ${i}`}return n.forEach(({prop:n,value:a})=>{if(!o.has(n)&&!c(n,a)){if("margin-top"===n&&t.has("margin-right")&&t.has("margin-bottom")&&t.has("margin-left")){const n=i([t.get("margin-top"),t.get("margin-right"),t.get("margin-bottom"),t.get("margin-left")]);return c("margin",n)||e.push({prop:"margin",value:n}),o.add("margin-top"),o.add("margin-right"),o.add("margin-bottom"),void o.add("margin-left")}if("padding-top"===n&&t.has("padding-right")&&t.has("padding-bottom")&&t.has("padding-left")){const n=i([t.get("padding-top"),t.get("padding-right"),t.get("padding-bottom"),t.get("padding-left")]);return c("padding",n)||e.push({prop:"padding",value:n}),o.add("padding-top"),o.add("padding-right"),o.add("padding-bottom"),void o.add("padding-left")}if("border-top-left-radius"===n&&t.has("border-top-right-radius")&&t.has("border-bottom-right-radius")&&t.has("border-bottom-left-radius")){const n=t.get("border-top-left-radius"),i=t.get("border-top-right-radius"),a=t.get("border-bottom-right-radius"),s=t.get("border-bottom-left-radius");return r(n,i,a,s)?c("border-radius",n)||e.push({prop:"border-radius",value:n}):e.push({prop:"border-radius",value:`${n} ${i} ${a} ${s}`}),o.add("border-top-left-radius"),o.add("border-top-right-radius"),o.add("border-bottom-right-radius"),void o.add("border-bottom-left-radius")}if("border-top-width"===n&&t.has("border-top-style")&&t.has("border-top-color")){const n=t.get("border-top-width"),r=t.get("border-top-style"),i=t.get("border-top-color");if(t.get("border-right-width")===n&&t.get("border-bottom-width")===n&&t.get("border-left-width")===n&&t.get("border-right-style")===r&&t.get("border-bottom-style")===r&&t.get("border-left-style")===r&&t.get("border-right-color")===i&&t.get("border-bottom-color")===i&&t.get("border-left-color")===i&&"none"!==r)return e.push({prop:"border",value:`${n} ${r} ${i}`}),o.add("border-top-width"),o.add("border-right-width"),o.add("border-bottom-width"),o.add("border-left-width"),o.add("border-top-style"),o.add("border-right-style"),o.add("border-bottom-style"),o.add("border-left-style"),o.add("border-top-color"),o.add("border-right-color"),o.add("border-bottom-color"),o.add("border-left-color"),o.add("border-image-source"),o.add("border-image-slice"),o.add("border-image-width"),o.add("border-image-outset"),void o.add("border-image-repeat")}if("background-color"===n&&"none"===t.get("background-image")&&"repeat"===t.get("background-repeat")&&"scroll"===t.get("background-attachment")&&"0%"===t.get("background-position-x")&&"0%"===t.get("background-position-y"))return e.push({prop:"background",value:a}),o.add("background-color"),o.add("background-image"),o.add("background-repeat"),o.add("background-attachment"),o.add("background-position"),o.add("background-position-x"),o.add("background-position-y"),o.add("background-size"),o.add("background-origin"),void o.add("background-clip");o.has(n)||(!n.startsWith("background-")||"background-position-x"!==n&&"background-position-y"!==n&&"background-repeat"!==n&&"background-attachment"!==n&&"background-origin"!==n&&"background-clip"!==n&&"background-size"!==n||"none"!==t.get("background-image")?n.startsWith("border-image-")&&"none"===t.get("border-image-source")?o.add(n):(o.add(n),e.push({prop:n,value:a})):o.add(n))}}),e}function p(n){let t=n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");let e=0;const o=[];function r(n){const t=`\0${e++}\0`;return o.push({marker:t,html:n}),t}const i=t.split("\n").map(n=>/^[^:]*\{/.test(n)?n.replace(/^([^{]+)(\{.*)$/,(n,t,e)=>r(`<span style="color: #fbbf24; font-weight: 600;">${t}</span>`)+e.replace(/\{/g,()=>r('<span style="color: #f87171; font-weight: bold;">{</span>'))):/^\s*\}/.test(n)?n.replace(/\}/g,()=>r('<span style="color: #f87171; font-weight: bold;">}</span>')):/:/.test(n)?n.replace(/^(\s+)([a-zA-Z-]+)(\s*):\s*([^;]+)(;?)(.*)$/,(n,t,e,o,i,a,s)=>{let c=i;c=c.replace(/(rgba?\([^)]+\))/gi,n=>r(`<span style="color: #a78bfa; font-weight: 600;">${n}</span>`)),c=c.replace(/(#[0-9a-fA-F]{3,8})\b/g,n=>r(`<span style="color: #a78bfa; font-weight: 600;">${n}</span>`)),c=c.replace(/\b(\d+(?:\.\d+)?)(px|em|rem|%|vh|vw|deg|s|ms|fr)\b/g,n=>r(`<span style="color: #fb923c;">${n}</span>`)),c=c.replace(/!important\b/g,n=>r(`<span style="color: #ef4444; font-weight: 600;">${n}</span>`));return`${t}${r(`<span style="color: #60a5fa;">${e}</span>`)}${o}: ${r(`<span style="color: #34d399;">${c}</span>`)}${a}${s}`}):n);return t=i.join("\n"),o.forEach(({marker:n,html:e})=>{t=t.replace(n,e)}),t}function d(n){let t="";const e=i(n,r.settings.selectorMode),o=l(a(n,!1));t+=`${e} {\n`,o.forEach(({prop:n,value:e})=>{t+=`  ${n}: ${e};\n`}),t+="}\n";const s=n.querySelectorAll("*"),c=new Map,p=Array.from(s).slice(0,200);return s.length>200&&(t+=`\n/* Warning: Only showing first 200 of ${s.length} child elements */\n`),p.forEach(n=>{const e=i(n,r.settings.selectorMode),o=l(a(n,!1));if(o.length>0){const n=`${e}::${o.map(({prop:n,value:t})=>`${n}:${t}`).sort().join(";")}`;c.has(n)||(c.set(n,!0),t+=`\n${e} {\n`,o.forEach(({prop:n,value:e})=>{t+=`  ${n}: ${e};\n`}),t+="}\n")}}),t}function u(n,t=!0){let e;if(t)e=n.outerHTML;else{e=n.cloneNode(!1).outerHTML.replace("></",">…</")}return function(n){let t="",e=0;const o="  ";return n.split(/(<[^>]+>)/g).forEach(n=>{n.trim()&&(n.startsWith("</")?(e=Math.max(0,e-1),t+=o.repeat(e)+n+"\n"):n.startsWith("<")?(t+=o.repeat(e)+n+"\n",n.endsWith("/>")||n.startsWith("</")||n.startsWith("<!")||e++):t+=o.repeat(e)+n.trim()+"\n")}),t.trim()}(e)}async function m(n,t=null){try{await navigator.clipboard.writeText(n),g(t||o("notificationCopied"))}catch(n){console.error("Failed to copy:",n),g(o("Failed to copy"),"error")}}function g(n,t="success"){const e=document.createElement("div");e.textContent=n,e.style.cssText=`\n      position: fixed !important;\n      top: 20px !important;\n      right: 20px !important;\n      background: ${"error"===t?"#ef4444":"#10b981"} !important;\n      color: white !important;\n      padding: 12px 24px !important;\n      border-radius: 6px !important;\n      z-index: 2147483647 !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      font-size: 14px !important;\n      box-shadow: 0 4px 6px rgba(0,0,0,0.3) !important;\n      animation: cssScannerSlideIn 0.3s ease !important;\n    `,document.body.appendChild(e),setTimeout(()=>{e.style.animation="cssScannerSlideOut 0.3s ease",setTimeout(()=>e.remove(),300)},2e3)}function b(){const n=document.getElementById("css-scanner-live-edit");n&&(n.remove(),g("Live CSS reset!"))}function h(){const n=document.createElement("div");n.id="css-scanner-block",n.innerHTML=`\n      <div class="inspector-header">\n        <div class="inspector-title">\n          <span class="element-tag"></span>\n          <span class="element-size"></span>\n        </div>\n        <div class="inspector-actions">\n          <button class="btn-guide" title="${o("btnGuide")}">?</button>\n          <button class="btn-settings" title="${o("btnSettings")}">⚙</button>\n          <button class="btn-close" title="${o("btnClose")}">×</button>\n        </div>\n      </div>\n\n      <div class="inspector-breadcrumb"></div>\n\n      <div class="inspector-tabs">\n        <button class="tab-btn scanner-tab active" data-tab="css">${o("tabCSS")}</button>\n        <button class="tab-btn scanner-tab" data-tab="html">${o("tabHTML")}</button>\n        <button class="tab-btn scanner-tab" data-tab="source">${o("tabSource")}</button>\n        <button class="tab-btn scanner-tab" data-tab="editor">${o("tabEditor")}</button>\n      </div>\n\n      <div class="inspector-toolbar">\n        <button class="btn-copy-code btn-copy">${o("btnCopy")}</button>\n        <button class="btn-codepen">${o("btnCodePen")}</button>\n        <button class="btn-pin">${o("btnPin")}</button>\n      </div>\n\n      <div class="inspector-content">\n        <div class="tab-content active" data-tab="css">\n          <div class="css-options">\n            <label for="include-children-css">\n              <input type="checkbox" id="include-children-css">\n              ${o("optionIncludeChildren")}\n            </label>\n          </div>\n          <pre class="css-code"></pre>\n        </div>\n\n        <div class="tab-content" data-tab="html">\n          <div class="html-options">\n            <label for="include-children-html">\n              <input type="checkbox" id="include-children-html" checked>\n              ${o("optionIncludeChildren")}\n            </label>\n          </div>\n          <pre class="html-code"></pre>\n        </div>\n\n        <div class="tab-content" data-tab="source">\n          <div class="source-list"></div>\n        </div>\n\n        <div class="tab-content" data-tab="editor">\n          <div class="editor-controls">\n            <button class="btn-apply-css btn-apply">${o("btnApply")}</button>\n            <button class="btn-reset-css btn-reset">${o("btnReset")}</button>\n          </div>\n          <div class="editor-wrapper">\n            <pre class="editor-highlight" aria-hidden="true"></pre>\n            <textarea class="css-editor" placeholder="${o("tabEditor")}..." spellcheck="false"></textarea>\n          </div>\n        </div>\n      </div>\n\n      <div class="inspector-footer">\n        <span>${o("footerSpace")} ${o("footerTo")} ${r.frozen?o("footerUnfreeze"):o("footerFreeze")} • ${o("footerBackspace")} ${o("footerTo")} ${r.frozen?o("footerFreeze"):o("footerUnfreeze")} • ${o("footerEsc")} ${o("footerTo")} ${o("footerClose")}</span>\n      </div>\n    `,function(){if(document.getElementById("css-scanner-styles"))return;const n=document.createElement("style");n.id="css-scanner-styles",n.textContent="\n      @keyframes cssScannerSlideIn {\n        from { transform: translateX(100%); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n      }\n\n      @keyframes cssScannerSlideOut {\n        from { transform: translateX(0); opacity: 1; }\n        to { transform: translateX(100%); opacity: 0; }\n      }\n\n      #css-scanner-block {\n        position: fixed !important;\n        display: flex !important;\n        visibility: visible !important;\n        opacity: 1 !important;\n        background: #1f2937 !important;\n        color: #f3f4f6 !important;\n        border: 2px solid #3b82f6 !important;\n        border-radius: 8px !important;\n        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5) !important;\n        z-index: 2147483647 !important;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Courier New', monospace !important;\n        font-size: 13px !important;\n        line-height: 1.5 !important;\n        width: 600px !important;\n        max-height: 80vh !important;\n        flex-direction: column !important;\n        overflow: hidden !important;\n      }\n\n      #css-scanner-block * {\n        box-sizing: border-box !important;\n      }\n\n      .inspector-header {\n        background: #111827 !important;\n        padding: 12px 16px !important;\n        border-bottom: 1px solid #374151 !important;\n        display: flex !important;\n        justify-content: space-between !important;\n        align-items: center !important;\n        cursor: move !important;\n      }\n\n      .inspector-title {\n        display: flex !important;\n        flex-direction: column !important;\n      }\n\n      .element-tag {\n        color: #60a5fa !important;\n        font-weight: 600 !important;\n        font-size: 14px !important;\n      }\n\n      .element-size {\n        color: #9ca3af !important;\n        font-size: 11px !important;\n        margin-top: 2px !important;\n      }\n\n      .inspector-actions {\n        display: flex !important;\n        gap: 8px !important;\n      }\n\n      .inspector-actions button {\n        background: transparent !important;\n        border: 1px solid #4b5563 !important;\n        color: #f3f4f6 !important;\n        padding: 4px 8px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 16px !important;\n        line-height: 1 !important;\n      }\n\n      .inspector-actions button:hover {\n        background: #374151 !important;\n      }\n\n      .inspector-breadcrumb {\n        background: #111827 !important;\n        padding: 8px 16px !important;\n        border-bottom: 1px solid #374151 !important;\n        font-size: 11px !important;\n        color: #9ca3af !important;\n        overflow-x: auto !important;\n        overflow-y: hidden !important;\n        white-space: nowrap !important;\n        max-height: 32px !important;\n        scrollbar-width: thin !important;\n        scrollbar-color: #4b5563 #111827 !important;\n      }\n\n      .inspector-breadcrumb::-webkit-scrollbar {\n        height: 4px !important;\n      }\n\n      .inspector-breadcrumb::-webkit-scrollbar-track {\n        background: #111827 !important;\n      }\n\n      .inspector-breadcrumb::-webkit-scrollbar-thumb {\n        background: #4b5563 !important;\n        border-radius: 2px !important;\n      }\n\n      .inspector-breadcrumb::-webkit-scrollbar-thumb:hover {\n        background: #6b7280 !important;\n      }\n\n      .breadcrumb-item {\n        cursor: pointer !important;\n        color: #60a5fa !important;\n      }\n\n      .breadcrumb-item:hover {\n        text-decoration: underline !important;\n      }\n\n      .breadcrumb-ellipsis {\n        color: #fbbf24 !important;\n        font-weight: bold !important;\n        cursor: help !important;\n        padding: 0 4px !important;\n      }\n\n      .inspector-tabs {\n        background: #111827 !important;\n        display: block !important;\n        border-bottom: 1px solid #374151 !important;\n        padding: 0 16px !important;\n      }\n\n      .tab-btn {\n        background: transparent !important;\n        border: none !important;\n        color: #9ca3af !important;\n        padding: 10px 16px !important;\n        cursor: pointer !important;\n        font-size: 13px !important;\n        border-bottom: 2px solid transparent !important;\n        margin-bottom: -1px !important;\n        margin-right: 0 !important;\n        white-space: nowrap !important;\n        display: inline-block !important;\n        vertical-align: bottom !important;\n        float: none !important;\n      }\n\n      .tab-btn:hover {\n        color: #f3f4f6 !important;\n      }\n\n      .tab-btn.active {\n        color: #60a5fa !important;\n        border-bottom-color: #60a5fa !important;\n      }\n\n      .inspector-toolbar {\n        background: #1f2937 !important;\n        padding: 10px 16px !important;\n        border-bottom: 1px solid #374151 !important;\n        display: flex !important;\n        gap: 8px !important;\n      }\n\n      .inspector-toolbar button {\n        background: #3b82f6 !important;\n        border: none !important;\n        color: white !important;\n        padding: 6px 12px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 12px !important;\n        font-weight: 500 !important;\n      }\n\n      .inspector-toolbar button:hover {\n        background: #2563eb !important;\n      }\n\n      .btn-pin {\n        background: #6b7280 !important;\n      }\n\n      .btn-pin:hover {\n        background: #4b5563 !important;\n      }\n\n      .inspector-content {\n        flex: 1 !important;\n        overflow-y: auto !important;\n        background: #1f2937 !important;\n        max-height: 50vh !important;\n      }\n\n      .tab-content {\n        display: none !important;\n      }\n\n      .tab-content.active {\n        display: block !important;\n      }\n\n      .css-code, .html-code {\n        padding: 16px !important;\n        margin: 0 !important;\n        color: #f3f4f6 !important;\n        font-family: 'Courier New', Courier, monospace !important;\n        font-size: 12px !important;\n        line-height: 1.6 !important;\n        background: transparent !important;\n        white-space: pre-wrap !important;\n        word-wrap: break-word !important;\n        user-select: text !important;\n        cursor: text !important;\n      }\n\n      .css-options,\n      .html-options {\n        padding: 12px 16px !important;\n        background: #111827 !important;\n        border-bottom: 1px solid #374151 !important;\n      }\n\n      .css-options label,\n      .html-options label {\n        display: flex !important;\n        align-items: center !important;\n        gap: 8px !important;\n        color: #f3f4f6 !important;\n        font-size: 12px !important;\n        cursor: pointer !important;\n      }\n\n      .css-options input[type=\"checkbox\"],\n      .html-options input[type=\"checkbox\"] {\n        cursor: pointer !important;\n      }\n\n      .source-list {\n        min-height: 200px !important;\n      }\n\n      .editor-controls {\n        padding: 12px 16px !important;\n        background: #111827 !important;\n        border-bottom: 1px solid #374151 !important;\n        display: flex !important;\n        gap: 8px !important;\n      }\n\n      .editor-controls button {\n        background: #10b981 !important;\n        border: none !important;\n        color: white !important;\n        padding: 6px 12px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 12px !important;\n        font-weight: 500 !important;\n      }\n\n      .editor-controls button:hover {\n        background: #059669 !important;\n      }\n\n      .btn-reset-css {\n        background: #ef4444 !important;\n      }\n\n      .btn-reset-css:hover {\n        background: #dc2626 !important;\n      }\n\n      .editor-wrapper {\n        position: relative !important;\n        width: 100% !important;\n        overflow: hidden !important;\n        border-radius: 4px !important;\n      }\n\n      .editor-highlight {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        min-height: 300px !important;\n        padding: 16px !important;\n        margin: 0 !important;\n        background: #111827 !important;\n        color: transparent !important;\n        font-family: 'Courier New', Courier, monospace !important;\n        font-size: 12px !important;\n        line-height: 1.6 !important;\n        white-space: pre-wrap !important;\n        word-wrap: break-word !important;\n        pointer-events: none !important;\n        z-index: 1 !important;\n        overflow: hidden !important;\n      }\n\n      .css-editor {\n        position: relative !important;\n        width: 100% !important;\n        min-height: 300px !important;\n        padding: 16px !important;\n        background: transparent !important;\n        color: #f3f4f6 !important;\n        border: none !important;\n        font-family: 'Courier New', Courier, monospace !important;\n        font-size: 12px !important;\n        line-height: 1.6 !important;\n        resize: vertical !important;\n        z-index: 2 !important;\n        caret-color: #f3f4f6 !important;\n      }\n\n      .css-editor:focus {\n        outline: none !important;\n      }\n\n      .inspector-footer {\n        background: #111827 !important;\n        padding: 8px 16px !important;\n        border-top: 1px solid #374151 !important;\n        font-size: 11px !important;\n        color: #9ca3af !important;\n        text-align: center !important;\n      }\n\n      #css-scanner-options .options-header {\n        background: #111827 !important;\n        padding: 16px 20px !important;\n        border-bottom: 1px solid #374151 !important;\n        display: flex !important;\n        justify-content: space-between !important;\n        align-items: center !important;\n      }\n\n      #css-scanner-options h3 {\n        margin: 0 !important;\n        color: #f3f4f6 !important;\n        font-size: 18px !important;\n        font-weight: 600 !important;\n      }\n\n      .btn-close-options {\n        background: transparent !important;\n        border: 1px solid #4b5563 !important;\n        color: #f3f4f6 !important;\n        width: 28px !important;\n        height: 28px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 20px !important;\n        line-height: 1 !important;\n        display: flex !important;\n        align-items: center !important;\n        justify-content: center !important;\n      }\n\n      .btn-close-options:hover {\n        background: #374151 !important;\n      }\n\n      #css-scanner-options .options-content {\n        padding: 20px !important;\n      }\n\n      .options-section {\n        margin-bottom: 24px !important;\n      }\n\n      .options-section h4 {\n        margin: 0 0 12px 0 !important;\n        color: #60a5fa !important;\n        font-size: 13px !important;\n        font-weight: 600 !important;\n      }\n\n      .options-section label {\n        display: flex !important;\n        align-items: center !important;\n        gap: 8px !important;\n        margin-bottom: 8px !important;\n        color: #f3f4f6 !important;\n        font-size: 13px !important;\n        cursor: pointer !important;\n      }\n\n      .options-section input[type=\"checkbox\"],\n      .options-section input[type=\"radio\"] {\n        cursor: pointer !important;\n      }\n\n      #css-scanner-options .options-footer {\n        background: #111827 !important;\n        padding: 16px 20px !important;\n        border-top: 1px solid #374151 !important;\n        text-align: right !important;\n      }\n\n      .btn-save-options {\n        background: #3b82f6 !important;\n        border: none !important;\n        color: white !important;\n        padding: 10px 20px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 13px !important;\n        font-weight: 600 !important;\n      }\n\n      .btn-save-options:hover {\n        background: #2563eb !important;\n      }\n    ",document.head.appendChild(n)}();n.querySelectorAll(".tab-btn").forEach(n=>{n.addEventListener("click",t=>{t.stopPropagation(),x(n.dataset.tab)})});n.querySelector(".btn-close").addEventListener("click",n=>{n.stopPropagation(),M()});n.querySelector(".btn-guide").addEventListener("click",n=>{n.stopPropagation(),f()});n.querySelector(".btn-settings").addEventListener("click",n=>{n.stopPropagation(),function(){r.optionsPanel||(r.optionsPanel=y());"none"===r.optionsPanel.style.display?(v(r.optionsPanel),r.optionsPanel.style.display="block"):r.optionsPanel.style.display="none"}()});n.querySelector(".btn-copy-code").addEventListener("click",n=>{n.stopPropagation(),function(){switch(r.currentTab){case"css":C();break;case"html":m(r.displayedHTML,"HTML copied!");break;case"source":!function(){let n="CSS Sources:\n\n";r.sourceFiles.forEach(({url:t,ruleCount:e})=>{n+=`${t} (${e} rules)\n`}),m(n,"Sources copied!")}();break;case"editor":m(r.inspectorBlock.querySelector(".css-editor").value,"Editor code copied!")}}()});n.querySelector(".btn-codepen").addEventListener("click",n=>{n.stopPropagation(),function(){const n=u(r.currentElement,r.settings.includeChildren);let t="";if(r.settings.includeChildren)t=d(r.currentElement);else{const n=r.displayedCSS.map(({prop:n,value:t})=>`  ${n}: ${t};`).join("\n");t=`${i(r.currentElement,r.settings.selectorMode)} {\n${n}\n}`}const e={title:"CSS Scanner Pro - Export by Simon Adjatan",html:n,css:t,js:"",editors:"110"},o=document.createElement("form");o.action="https://codepen.io/pen/define",o.method="POST",o.target="_blank";const a=document.createElement("input");a.type="hidden",a.name="data",a.value=JSON.stringify(e),o.appendChild(a),document.body.appendChild(o),o.submit(),document.body.removeChild(o),g("Opening in CodePen with "+(r.settings.includeChildren?"full component CSS":"element CSS")+"...")}()});n.querySelector(".btn-pin").addEventListener("click",n=>{n.stopPropagation(),L()});n.querySelector(".btn-apply-css").addEventListener("click",t=>{t.stopPropagation();!function(n){let t=document.getElementById("css-scanner-live-edit");t||(t=document.createElement("style"),t.id="css-scanner-live-edit",document.head.appendChild(t)),t.textContent=n,g("Live CSS applied!")}(n.querySelector(".css-editor").value)});n.querySelector(".btn-reset-css").addEventListener("click",t=>{t.stopPropagation(),b();const e=n.querySelector(".css-editor"),o=n.querySelector(".editor-highlight");e.value=r.originalCSS,o&&(o.innerHTML=p(r.originalCSS))});const t=n.querySelector(".css-editor"),e=n.querySelector(".editor-highlight");t.addEventListener("input",n=>{e&&(e.innerHTML=p(n.target.value))}),t.addEventListener("scroll",n=>{e&&(e.scrollTop=n.target.scrollTop,e.scrollLeft=n.target.scrollLeft)});n.querySelector("#include-children-html").addEventListener("change",n=>{n.stopPropagation(),r.settings.includeChildrenHTML=n.target.checked,r.currentElement&&S()});n.querySelector("#include-children-css").addEventListener("change",n=>{n.stopPropagation(),r.settings.includeChildren=n.target.checked,r.currentElement&&k()});let a=!1,s=0,c=0,l=0,h=0;const $=n.querySelector(".inspector-header");return $.style.cursor="move",$.addEventListener("mousedown",n=>{n.target.closest(".inspector-actions")||(a=!0,l=n.clientX-s,h=n.clientY-c)}),document.addEventListener("mousemove",t=>{a&&(t.preventDefault(),s=t.clientX-l,c=t.clientY-h,n.style.transform=`translate(${s}px, ${c}px)`)}),document.addEventListener("mouseup",()=>{a=!1}),document.body.appendChild(n),n}function f(){let n=document.getElementById("css-scanner-guide-overlay");if(n){n.style.display="block";const t=n.querySelector(".guide-close"),e=n.querySelector(".guide-backdrop"),o=n.querySelector(".guide-panel");if(t){console.log("Reattaching close button, element:",t);const e=t=>{t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),console.log("Close button activated (reattached)"),n.style.display="none"};t.onclick=e,t.onmousedown=e,t.addEventListener("click",e,!0),t.style.cursor="pointer",console.log("Close button handlers set (onclick, onmousedown, addEventListener)")}else console.error("Close button not found!");return e&&(e.onclick=t=>{console.log("Backdrop clicked (reattached)"),n.style.display="none"}),void(o&&(o.onclick=n=>{n.stopPropagation(),console.log("Panel clicked - not closing (reattached)")}))}const t=navigator.platform.toUpperCase().indexOf("MAC")>=0;n=document.createElement("div"),n.id="css-scanner-guide-overlay";const e=t?"Cmd+Shift+S":"Ctrl+Shift+S";n.innerHTML=`\n      <div class="guide-backdrop"></div>\n      <div class="guide-panel">\n        <div class="guide-header">\n          <h2>${o("guideTitle")}</h2>\n          <button class="guide-close">&times;</button>\n        </div>\n        <div class="guide-content">\n          <div class="guide-section">\n            <h3>${o("guideQuickStart")}</h3>\n            <div class="guide-shortcuts">\n              <div class="guide-shortcut">\n                <span>${o("shortcutActivateScanner")}</span>\n                <kbd>Ctrl+Shift+S</kbd>\n              </div>\n              <div class="guide-shortcut">\n                <span>${o("shortcutToggleGrid")}</span>\n                <kbd>Ctrl+Shift+G</kbd>\n              </div>\n              <div class="guide-shortcut">\n                <span>${o("shortcutScanParent")}</span>\n                <kbd>Ctrl+Shift+E</kbd>\n              </div>\n            </div>\n          </div>\n\n          <div class="guide-section">\n            <h3>${o("guideHowToUse")}</h3>\n            <ol class="guide-steps">\n              <li>${o("guideStep1",e)}</li>\n              <li>${o("guideStep2")}</li>\n              <li>${o("guideStep3",["<strong>"+o("tabCSS")+"</strong>","<strong>"+o("tabHTML")+"</strong>","<strong>"+o("tabSource")+"</strong>","<strong>"+o("tabEditor")+"</strong>"])}</li>\n              <li>${o("guideStep4","<strong>"+o("btnCopy")+"</strong>")}</li>\n              <li>${o("guideStep5",["<kbd>Space</kbd>","<kbd>Esc</kbd>"])}</li>\n            </ol>\n          </div>\n\n          <div class="guide-section">\n            <h3>${o("guideFeatures")}</h3>\n            <ul class="guide-features">\n              <li>${o("featureSyntaxHighlighting")}</li>\n              <li>${o("featureIncludeChildren")}</li>\n              <li>${o("featureLiveEditor")}</li>\n              <li>${o("featureCodePenExport")}</li>\n              <li>${o("featureOptimizedCSS")}</li>\n            </ul>\n          </div>\n\n          <div class="guide-tip">\n            <strong>${o("guideProTip")}</strong> ${o("proTipMessage")}\n          </div>\n        </div>\n      </div>\n    `;const r=document.createElement("style");r.textContent="\n      #css-scanner-guide-overlay {\n        position: fixed !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100vw !important;\n        height: 100vh !important;\n        z-index: 2147483647 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-backdrop {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n        background: rgba(0, 0, 0, 0.7) !important;\n        cursor: pointer !important;\n        z-index: 1 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-panel {\n        position: absolute !important;\n        top: 50% !important;\n        left: 50% !important;\n        transform: translate(-50%, -50%) !important;\n        width: 90% !important;\n        max-width: 600px !important;\n        max-height: 80vh !important;\n        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%) !important;\n        border-radius: 12px !important;\n        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5) !important;\n        overflow: hidden !important;\n        display: flex !important;\n        flex-direction: column !important;\n        z-index: 2 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-header {\n        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important;\n        padding: 20px !important;\n        display: flex !important;\n        justify-content: space-between !important;\n        align-items: center !important;\n        position: relative !important;\n        z-index: 3 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-header h2 {\n        margin: 0 !important;\n        color: white !important;\n        font-size: 20px !important;\n        font-weight: 700 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-close {\n        background: rgba(255, 255, 255, 0.1) !important;\n        border: none !important;\n        color: white !important;\n        width: 32px !important;\n        height: 32px !important;\n        border-radius: 6px !important;\n        font-size: 24px !important;\n        cursor: pointer !important;\n        transition: all 0.2s !important;\n        display: flex !important;\n        align-items: center !important;\n        justify-content: center !important;\n        line-height: 1 !important;\n        pointer-events: auto !important;\n        position: relative !important;\n        z-index: 10 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-close:hover {\n        background: rgba(255, 255, 255, 0.2) !important;\n        transform: scale(1.1) !important;\n      }\n\n      #css-scanner-guide-overlay .guide-content {\n        padding: 24px !important;\n        overflow-y: auto !important;\n        color: #f1f5f9 !important;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      }\n\n      #css-scanner-guide-overlay .guide-section {\n        margin-bottom: 24px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-section h3 {\n        color: #60a5fa !important;\n        font-size: 16px !important;\n        font-weight: 600 !important;\n        margin: 0 0 12px 0 !important;\n        border-left: 4px solid #3b82f6 !important;\n        padding-left: 12px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-shortcuts {\n        display: flex !important;\n        flex-direction: column !important;\n        gap: 8px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-shortcut {\n        display: flex !important;\n        justify-content: space-between !important;\n        align-items: center !important;\n        padding: 10px 12px !important;\n        background: #1e293b !important;\n        border: 1px solid #334155 !important;\n        border-radius: 6px !important;\n        font-size: 13px !important;\n        color: #cbd5e1 !important;\n      }\n\n      #css-scanner-guide-overlay kbd {\n        background: #0f172a !important;\n        padding: 4px 10px !important;\n        border-radius: 4px !important;\n        font-family: 'Courier New', monospace !important;\n        font-size: 11px !important;\n        color: #60a5fa !important;\n        border: 1px solid #1e293b !important;\n        font-weight: 600 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-steps,\n      #css-scanner-guide-overlay .guide-features {\n        margin: 0 !important;\n        padding-left: 24px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-steps li,\n      #css-scanner-guide-overlay .guide-features li {\n        color: #cbd5e1 !important;\n        font-size: 13px !important;\n        line-height: 1.6 !important;\n        margin-bottom: 8px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-tip {\n        background: #0f172a !important;\n        border-left: 3px solid #fbbf24 !important;\n        padding: 12px !important;\n        border-radius: 4px !important;\n        font-size: 13px !important;\n        color: #e2e8f0 !important;\n        line-height: 1.6 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-tip strong {\n        color: #fbbf24 !important;\n      }\n    ",n.appendChild(r),document.body.appendChild(n);const i=n.querySelector(".guide-close"),a=n.querySelector(".guide-backdrop"),s=n.querySelector(".guide-panel"),c=()=>{console.log("Close guide called"),n.style.display="none"};if(i){console.log("Initial close button setup, element:",i);const n=n=>{n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),console.log("Close button activated (initial)"),c()};i.onclick=n,i.onmousedown=n,i.addEventListener("click",n,!0),i.style.cursor="pointer",console.log("Initial close button handlers set (onclick, onmousedown, addEventListener)")}else console.error("Close button not found during initial setup!");a&&(a.onclick=n=>{console.log("Backdrop clicked"),c()}),s&&(s.onclick=n=>{n.stopPropagation(),console.log("Panel clicked - not closing")}),t&&n.querySelectorAll("kbd").forEach(n=>{n.textContent.includes("Ctrl")&&(n.textContent=n.textContent.replace("Ctrl","Cmd"))})}function y(){const i=document.createElement("div");i.id="css-scanner-options",i.innerHTML=`\n      <div class="options-header">\n        <h3>${o("settingsTitle")}</h3>\n        <button class="btn-close-options">×</button>\n      </div>\n\n      <div class="options-content">\n        <div class="options-section">\n          <h4>${o("settingsSectionOnClick")}</h4>\n          <label>\n            <input type="checkbox" id="opt-copy-on-click">\n            ${o("settingsOptionCopyOnClick")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-pin-on-space" checked>\n            ${o("settingsOptionPinOnSpace")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionChildCSS")}</h4>\n          <label>\n            <input type="radio" name="children-css" value="include">\n            ${o("settingsOptionIncludeChildren")}\n          </label>\n          <label>\n            <input type="radio" name="children-css" value="exclude" checked>\n            ${o("settingsOptionExcludeChildren")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionHTML")}</h4>\n          <label>\n            <input type="checkbox" id="opt-copy-html">\n            ${o("settingsOptionCopyHTML")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionDisplay")}</h4>\n          <label>\n            <input type="checkbox" id="opt-show-grid">\n            ${o("settingsOptionShowGrid")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-show-guidelines">\n            ${o("settingsOptionGuidelines")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionLanguage")}</h4>\n          <select id="opt-language" style="width: 100%; padding: 8px; background: #374151; color: #f3f4f6; border: 1px solid #4b5563; border-radius: 4px; font-size: 14px;">\n            <option value="auto">${o("settingsLanguageAuto")}</option>\n            <option value="en">English</option>\n            <option value="fr">Français (French)</option>\n            <option value="es">Español (Spanish)</option>\n            <option value="de">Deutsch (German)</option>\n          </select>\n          <p style="font-size: 12px; color: #9ca3af; margin-top: 4px; margin-bottom: 0;">\n            ${o("settingsLanguageHelp")}\n          </p>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionSelectors")}</h4>\n          <label>\n            <input type="radio" name="selector-mode" value="smart" checked>\n            ${o("settingsSelectorSmart")}\n          </label>\n          <label>\n            <input type="radio" name="selector-mode" value="original">\n            ${o("settingsSelectorOriginal")}\n          </label>\n          <label>\n            <input type="radio" name="selector-mode" value="none">\n            ${o("settingsSelectorNone")}\n          </label>\n          <label>\n            <input type="radio" name="selector-mode" value="truncated">\n            ${o("settingsSelectorTruncated")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionOther")}</h4>\n          <label>\n            <input type="checkbox" id="opt-ignore-inherited">\n            ${o("settingsOptionIgnoreInherited")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-ignore-vendor" checked>\n            ${o("settingsOptionIgnoreVendor")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-ignore-box-sizing">\n            ${o("settingsOptionIgnoreBoxSizing")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-convert-font-size">\n            ${o("settingsOptionConvertFontSize")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-nest-pseudo">\n            ${o("settingsOptionNestPseudo")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-convert-urls" checked>\n            ${o("settingsOptionConvertURLs")}\n          </label>\n        </div>\n      </div>\n\n      <div class="options-footer">\n        <button class="btn-save-options">${o("settingsSaveButton")}</button>\n      </div>\n    `,i.style.cssText="\n      display: none;\n      position: fixed !important;\n      top: 50% !important;\n      left: 50% !important;\n      transform: translate(-50%, -50%) !important;\n      background: #1f2937 !important;\n      color: #f3f4f6 !important;\n      padding: 0 !important;\n      border-radius: 8px !important;\n      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5) !important;\n      z-index: 2147483647 !important;\n      width: 500px !important;\n      max-height: 80vh !important;\n      overflow-y: auto !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n    ";i.querySelector(".btn-close-options").addEventListener("click",()=>{i.style.display="none"});return i.querySelector(".btn-save-options").addEventListener("click",()=>{!async function(){const i=r.optionsPanel;r.settings.copyOnClick=i.querySelector("#opt-copy-on-click").checked,r.settings.pinOnSpace=i.querySelector("#opt-pin-on-space").checked,r.settings.copyHTMLWithCSS=i.querySelector("#opt-copy-html").checked,r.settings.showGrid=i.querySelector("#opt-show-grid").checked,r.settings.showGuidelines=i.querySelector("#opt-show-guidelines").checked,r.settings.ignoreInherited=i.querySelector("#opt-ignore-inherited").checked,r.settings.ignoreVendorPrefixes=i.querySelector("#opt-ignore-vendor").checked,r.settings.ignoreBoxSizing=i.querySelector("#opt-ignore-box-sizing").checked,r.settings.convertFontSizeToPx=i.querySelector("#opt-convert-font-size").checked,r.settings.nestPseudoClasses=i.querySelector("#opt-nest-pseudo").checked,r.settings.convertRelativeURLs=i.querySelector("#opt-convert-urls").checked;const a=i.querySelector('input[name="children-css"]:checked');r.settings.includeChildren="include"===a.value;const s=i.querySelector('input[name="selector-mode"]:checked');r.settings.selectorMode=s.value;const c=i.querySelector("#opt-language"),l=c?c.value:"auto",p=r.settings.language!==l;r.settings.language=l,p&&(t=l,"auto"!==l?await e(l):n={},r.active&&r.inspectorBlock&&function(){if(!r.inspectorBlock)return;r.inspectorBlock.querySelectorAll(".scanner-tab").forEach(n=>{const t=n.getAttribute("data-tab");"css"===t&&(n.textContent=o("tabCSS")),"html"===t&&(n.textContent=o("tabHTML")),"source"===t&&(n.textContent=o("tabSource")),"editor"===t&&(n.textContent=o("tabEditor"))});const n=r.inspectorBlock.querySelector(".btn-copy");n&&(n.textContent=o("btnCopy"));const t=r.inspectorBlock.querySelector(".btn-codepen");t&&(t.textContent=o("btnCodePen"));const e=r.inspectorBlock.querySelector(".btn-pin");e&&(e.textContent=r.frozen?o("btnUnpin"):o("btnPin"));const i=r.inspectorBlock.querySelector(".btn-apply");i&&(i.textContent=o("btnApply"));const a=r.inspectorBlock.querySelector(".btn-reset");a&&(a.textContent=o("btnReset"));const s=r.inspectorBlock.querySelector('label[for="include-children-css"]');if(s){const n=s.querySelector("input");s.innerHTML="",s.appendChild(n),s.appendChild(document.createTextNode(o("optionIncludeChildren")))}const c=r.inspectorBlock.querySelector('label[for="include-children-html"]');if(c){const n=c.querySelector("input");c.innerHTML="",c.appendChild(n),c.appendChild(document.createTextNode(o("optionIncludeChildren")))}z(),"css"===r.currentTab&&k();"html"===r.currentTab&&S();"source"===r.currentTab&&$();"editor"===r.currentTab&&w();if(r.optionsPanel){const n="none"!==r.optionsPanel.style.display;r.settings;r.optionsPanel.remove(),r.optionsPanel=y(),n&&(r.optionsPanel.style.display="flex")}const l=document.getElementById("css-scanner-guide-overlay");if(l){const n="none"!==l.style.display;l.remove(),n&&f()}}());"undefined"!=typeof chrome&&chrome.storage?chrome.storage.sync.set({cssScanner:r.settings},()=>{g(o("settingsSave")+"d!")}):(localStorage.setItem("cssScanner",JSON.stringify(r.settings)),g(o("settingsSave")+"d!"))}(),i.style.display="none"}),v(i),document.body.appendChild(i),i}function v(n){n.querySelector("#opt-copy-on-click").checked=r.settings.copyOnClick,n.querySelector("#opt-pin-on-space").checked=r.settings.pinOnSpace,n.querySelector("#opt-copy-html").checked=r.settings.copyHTMLWithCSS,n.querySelector("#opt-show-grid").checked=r.settings.showGrid,n.querySelector("#opt-show-guidelines").checked=r.settings.showGuidelines,n.querySelector("#opt-ignore-inherited").checked=r.settings.ignoreInherited,n.querySelector("#opt-ignore-vendor").checked=r.settings.ignoreVendorPrefixes,n.querySelector("#opt-ignore-box-sizing").checked=r.settings.ignoreBoxSizing,n.querySelector("#opt-convert-font-size").checked=r.settings.convertFontSizeToPx,n.querySelector("#opt-nest-pseudo").checked=r.settings.nestPseudoClasses,n.querySelector("#opt-convert-urls").checked=r.settings.convertRelativeURLs;const t=n.querySelector("#opt-language");t&&(t.value=r.settings.language||"auto");const e=r.settings.includeChildren?"include":"exclude";n.querySelector(`input[name="children-css"][value="${e}"]`).checked=!0;const o=n.querySelector(`input[name="selector-mode"][value="${r.settings.selectorMode}"]`);o&&(o.checked=!0)}function x(n){r.currentTab=n;r.inspectorBlock.querySelectorAll(".tab-btn").forEach(t=>{t.dataset.tab===n?t.classList.add("active"):t.classList.remove("active")});if(r.inspectorBlock.querySelectorAll(".tab-content").forEach(t=>{t.dataset.tab===n?t.classList.add("active"):t.classList.remove("active")}),r.currentElement)switch(n){case"css":k();break;case"html":S();break;case"source":$();break;case"editor":w()}}function k(){const n=r.inspectorBlock.querySelector(".css-code");if(r.settings.includeChildren){const t=d(r.currentElement);n.innerHTML=p(t);const e=a(r.currentElement,!1);r.displayedCSS=l(e)}else{const t=l(a(r.currentElement,!1));r.displayedCSS=t;let e="";t.forEach(({prop:n,value:t})=>{e+=`  ${n}: ${t};\n`});const o=`${i(r.currentElement,r.settings.selectorMode)} {\n${e}}`;n.innerHTML=p(o)}}function S(){const n=r.inspectorBlock.querySelector(".html-code"),t=r.settings.includeChildrenHTML,e=u(r.currentElement,t);r.displayedHTML=e,n.innerHTML=function(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").split("\n").map(n=>{if(!n.trim())return n;let t=n;return t=t.replace(/&lt;!--(.*?)--&gt;/g,'<span style="color: #6b7280; font-style: italic;">&lt;!--$1--&gt;</span>'),t.includes("&lt;!--")||(t=t.replace(/&lt;\/(\w[\w-]*)&gt;/g,'&lt;<span style="color: #f87171;">/</span><span style="color: #fbbf24; font-weight: 600;">$1</span><span style="color: #f87171;">&gt;</span>'),t=t.replace(/&lt;(\w[\w-]*)((?:\s+[\w-]+(?:=&quot;[^&"]*&quot;)?)*)\s*(\/?)&gt;/g,(n,t,e,o)=>{let r='&lt;<span style="color: #fbbf24; font-weight: 600;">'+t+"</span>";return e&&(r+=e.replace(/\s+([\w-]+)(?:=(&quot;[^&"]*&quot;))?/g,(n,t,e)=>{let o=' <span style="color: #60a5fa;">'+t+"</span>";return e&&(o+='=<span style="color: #34d399;">'+e+"</span>"),o})),r+=o?'<span style="color: #f87171;">/&gt;</span>':'<span style="color: #f87171;">&gt;</span>',r})),t}).join("\n")}(e)}function $(){const n=r.inspectorBlock.querySelector(".source-list"),t=function(n){const t=[],e=new Set;try{for(const o of document.styleSheets)try{const r=Array.from(o.cssRules||[]).filter(t=>{try{if(t.selectorText)return n.matches(t.selectorText)}catch(n){return!1}return!1});if(r.length>0){const n=o.href||"inline styles";e.has(n)||(e.add(n),t.push({url:n,ruleCount:r.length}))}}catch(n){o.href&&!e.has(o.href)&&(e.add(o.href),t.push({url:o.href,ruleCount:"?"}))}}catch(n){console.error("Error getting source files:",n)}return n.style.length>0&&t.push({url:"element.style (inline)",ruleCount:n.style.length}),t}(r.currentElement);if(r.sourceFiles=t,0===t.length)return void(n.innerHTML='<p style="padding: 20px; color: #9ca3af;">No CSS sources found</p>');let e='<div style="padding: 10px;">';t.forEach(({url:n,ruleCount:t})=>{e+=`\n        <div style="margin-bottom: 12px; padding: 10px; background: #111827; border-radius: 4px;">\n          <div style="color: #60a5fa; font-size: 12px; margin-bottom: 4px; word-break: break-all;">${n}</div>\n          <div style="color: #9ca3af; font-size: 11px;">${t} ${1===t?"rule":"rules"}</div>\n        </div>\n      `}),e+="</div>",n.innerHTML=e}function w(){const n=r.inspectorBlock.querySelector(".css-editor"),t=r.inspectorBlock.querySelector(".editor-highlight");let e="";if(r.settings.includeChildren)e=d(r.currentElement);else{const n=i(r.currentElement,r.settings.selectorMode);let t="";r.displayedCSS.forEach(({prop:n,value:e})=>{t+=`  ${n}: ${e};\n`}),e=`${n} {\n${t}}`}r.originalCSS=e,n.value=e,t&&(t.innerHTML=p(e))}function C(){let n="";if(r.settings.includeChildren){n=r.inspectorBlock.querySelector(".css-code").textContent}else{let t="";r.displayedCSS.forEach(({prop:n,value:e})=>{t+=`  ${n}: ${e};\n`});n=`${i(r.currentElement,r.settings.selectorMode)} {\n${t}}`}if(r.settings.copyHTMLWithCSS){m(`${u(r.currentElement,r.settings.includeChildren)}\n\n<style>\n${n}\n</style>`,"HTML + CSS copied!")}else m(n,r.settings.includeChildren?"CSS with children copied!":"CSS copied!")}function E(n){if(!n||n===document.documentElement)return;r.currentElement=n;const t=n.getBoundingClientRect();r.overlay.style.top=`${t.top+window.scrollY}px`,r.overlay.style.left=`${t.left+window.scrollX}px`,r.overlay.style.width=`${t.width}px`,r.overlay.style.height=`${t.height}px`;const e=n.tagName.toLowerCase(),o=n.id?`#${n.id}`:"",i=n.classList.length>0?`.${Array.from(n.classList).join(".")}`:"",a=`${Math.round(t.width)}×${Math.round(t.height)}`;r.inspectorBlock.querySelector(".element-tag").textContent=`<${e}${o}${i}>`,r.inspectorBlock.querySelector(".element-size").textContent=a,function(n){const t=r.inspectorBlock.querySelector(".inspector-breadcrumb"),e=[],o=[];let i=n;function a(n,t=15){return n.length<=t?n:n.substring(0,t)+"..."}for(;i&&i!==document.body;){const n=i.tagName.toLowerCase(),t=i.id?`#${i.id}`:"",r=`${n}${t}${i.classList.length>0?`.${i.classList[0]}`:""}`;o.unshift(r);const s=`${n}${t}${i.classList.length>0?`.${a(i.classList[0])}`:""}`;e.unshift(s),i=i.parentElement}const s=r.settings.maxBreadcrumbDepth||0,c=s>0&&e.length>s,l=c?e.slice(-s):e,p=c?o.slice(-s):o;let d="";c&&(d=`<span class="breadcrumb-ellipsis" title="Path truncated - showing last ${s} of ${e.length} levels">...</span> › `);d+=l.map((n,t)=>{const o=p[t],r=o!==n?o:"";return`<span class="breadcrumb-item" data-index="${c?t+(e.length-s):t}" ${r?`title="${r}"`:""}>${n}</span>`}).join(" › "),t.innerHTML=d,t.querySelectorAll(".breadcrumb-item").forEach(t=>{t.addEventListener("click",e=>{e.stopPropagation();const r=parseInt(t.getAttribute("data-index"));let i=n;const a=o.length-1-r;for(let n=0;n<a;n++)i=i.parentElement;E(i)})})}(n),x(r.currentTab),r.frozen||function(n){const t=r.inspectorBlock,e=600,o=500;let i=n.left+n.width+20,a=n.top;i+e>window.innerWidth-10&&(i=n.left-e-20);i<10&&(i=10);a+o>window.innerHeight-10&&(a=window.innerHeight-o-10);a<10&&(a=10);t.style.left=`${i}px`,t.style.top=`${a}px`}(t)}function L(){r.frozen=!r.frozen,r.frozen?(r.inspectorBlock.style.borderColor="#ffd43b",r.overlay.style.borderColor="#ffd43b",g("Frozen - Space to unfreeze")):(r.inspectorBlock.style.borderColor="#3b82f6",r.overlay.style.borderColor="#3b82f6",g("Unfrozen")),z()}function z(){r.inspectorBlock.querySelector(".inspector-footer span").textContent=`${o("footerSpace")} ${o("footerTo")} ${r.frozen?o("footerUnfreeze"):o("footerFreeze")} • ${o("footerBackspace")} ${o("footerTo")} ${r.frozen?o("footerFreeze"):o("footerUnfreeze")} • ${o("footerEsc")} ${o("footerTo")} ${o("footerClose")}`}function q(n){r.frozen||r.active&&(n.target.closest("#css-scanner-block")||n.target.closest("#css-scanner-overlay")||n.target.closest("#css-scanner-options")||n.target.closest("#css-scanner-guide-overlay")||E(n.target))}function T(n){r.active&&(n.target.closest("#css-scanner-block")||n.target.closest("#css-scanner-options")||n.target.closest("#css-scanner-guide-overlay")||(n.preventDefault(),n.stopPropagation(),r.settings.copyOnClick&&C()))}function P(n){r.active&&(" "===n.key&&(n.preventDefault(),r.settings.pinOnSpace&&L()),"Backspace"===n.key&&(n.preventDefault(),r.frozen=!r.frozen,r.frozen?(r.inspectorBlock.style.borderColor="#ffd43b",r.overlay.style.borderColor="#ffd43b"):(r.inspectorBlock.style.borderColor="#3b82f6",r.overlay.style.borderColor="#3b82f6"),z()),"Escape"===n.key&&(n.preventDefault(),M()),"ArrowUp"===n.key&&(n.preventDefault(),r.currentElement&&r.currentElement.parentElement&&E(r.currentElement.parentElement)),"ArrowDown"===n.key&&(n.preventDefault(),r.currentElement&&r.currentElement.firstElementChild&&E(r.currentElement.firstElementChild)))}async function B(){if(r.active)return;r.active=!0,await async function(){return new Promise(n=>{"undefined"!=typeof chrome&&chrome.storage?chrome.storage.sync.get(["cssScanner"],async o=>{o.cssScanner&&(Object.assign(r.settings,o.cssScanner),r.settings.language&&"auto"!==r.settings.language&&(t=r.settings.language,await e(t))),n()}):(async()=>{const o=localStorage.getItem("cssScanner");if(o)try{Object.assign(r.settings,JSON.parse(o)),r.settings.language&&"auto"!==r.settings.language&&(t=r.settings.language,await e(t))}catch(n){console.error("Failed to load settings:",n)}n()})()})}(),r.overlay=function(){const n=document.createElement("div");return n.id="css-scanner-overlay",n.style.cssText="\n      position: absolute !important;\n      pointer-events: none !important;\n      border: 2px solid #3b82f6 !important;\n      background: rgba(59, 130, 246, 0.1) !important;\n      z-index: 2147483646 !important;\n      transition: all 0.1s ease !important;\n    ",document.body.appendChild(n),n}(),r.inspectorBlock=h();const n=r.inspectorBlock.querySelector("#include-children-css"),i=r.inspectorBlock.querySelector("#include-children-html");n&&(n.checked=r.settings.includeChildren),i&&(i.checked=r.settings.includeChildrenHTML),document.addEventListener("mousemove",q,!0),document.addEventListener("click",T,!0),document.addEventListener("keydown",P,!0),g(o("notificationActivated"))}function M(){r.active&&(r.active=!1,r.frozen=!1,document.removeEventListener("mousemove",q,!0),document.removeEventListener("click",T,!0),document.removeEventListener("keydown",P,!0),r.overlay&&(r.overlay.remove(),r.overlay=null),r.inspectorBlock&&(r.inspectorBlock.remove(),r.inspectorBlock=null),r.optionsPanel&&(r.optionsPanel.remove(),r.optionsPanel=null),b(),g(o("notificationDeactivated")))}chrome.runtime.onMessage.addListener((n,t,e)=>{"TOGGLE_SCANNER"===n.type&&(r.active?M():B())}),r.active||B()}();