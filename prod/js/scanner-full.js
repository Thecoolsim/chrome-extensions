/**
 * CSS Scanner Pro - Full Featured Version
 * Complete CSS Scanner with tabs, CodePen export, live editor, and more
 *
 * @author Simon Adjatan
 * @website https://adjatan.org/
 * @github https://github.com/Thecoolsim
 * @X https://x.com/adjatan
 * @facebook https://www.facebook.com/adjatan
 * @license MIT
 */
!function(){"use strict";if(window.__CSS_SCANNER_LOADED__)return;window.__CSS_SCANNER_LOADED__=!0;let t={},n="auto";async function e(n){if("auto"!==n)try{const e=await fetch(chrome.runtime.getURL(`_locales/${n}/messages.json`)),o=await e.json();t=o}catch(e){console.error(`Failed to load translations for ${n}:`,e),t={}}else t={}}const o=(e,o)=>{if("undefined"==typeof chrome||!chrome.i18n)return e;let r;if("auto"!==n&&t[e]){const n=t[e];if(r=n.message||n,o)if(Array.isArray(o)){if(o.forEach((t,n)=>{const e=new RegExp("\\$"+(n+1)+"\\$","g");r=r.replace(e,t)}),n.placeholders)for(const t in n.placeholders){const e=n.placeholders[t].content.match(/\$(\d+)/);if(e){const n=parseInt(e[1])-1;if(n<o.length){const e=new RegExp("\\$"+t.toUpperCase()+"\\$","gi");r=r.replace(e,o[n])}}}}else if(r=r.replace(/\$1\$/g,o),n.placeholders)for(const t in n.placeholders){const n=new RegExp("\\$"+t.toUpperCase()+"\\$","gi");r=r.replace(n,o)}}else r=chrome.i18n.getMessage(e,o)||e;return r},r={active:!1,frozen:!1,currentElement:null,currentTab:"css",displayedCSS:[],displayedHTML:"",sourceFiles:[],liveCSS:"",originalCSS:"",settings:{copyOnClick:!1,pinOnSpace:!0,includeChildren:!1,copyHTMLWithCSS:!1,showGrid:!1,showGuidelines:!1,selectorMode:"smart",maxBreadcrumbDepth:4,language:"auto",ignoreInherited:!1,ignoreVendorPrefixes:!0,ignoreBoxSizing:!1,convertFontSizeToPx:!1,nestPseudoClasses:!1,convertRelativeURLs:!0,includeChildrenHTML:!0},inspectorBlock:null,overlay:null,breadcrumb:null,optionsPanel:null};function i(t,n="smart"){if(!t||t===document.body)return"body";if(t===document.documentElement)return"html";if("smart"===n){if(t.id)return`#${t.id}`;if(t.classList.length>0){const n=Array.from(t.classList)[0];return`${t.tagName.toLowerCase()}.${n}`}const n=t.parentElement;if(n){const e=Array.from(n.children).indexOf(t)+1;return`${t.tagName.toLowerCase()}:nth-child(${e})`}}return t.tagName.toLowerCase()}function a(t,n=!1){const e=window.getComputedStyle(t),o=[];try{for(const n of document.styleSheets)try{s(Array.from(n.cssRules||[]),t,o)}catch(t){}}catch(t){console.error("Error reading stylesheets:",t)}const i=new Set;if(o.forEach(t=>{for(let n=0;n<t.style.length;n++)i.add(t.style[n])}),t.style.length>0)for(let n=0;n<t.style.length;n++)i.add(t.style[n]);const a=Array.from(i).filter(t=>(!r.settings.ignoreVendorPrefixes||!(t.startsWith("-webkit-")||t.startsWith("-moz-")||t.startsWith("-ms-")||t.startsWith("-o-")))&&(!r.settings.ignoreBoxSizing||"box-sizing"!==t)),c=[];return a.forEach(t=>{const n=e.getPropertyValue(t);n&&c.push({prop:t,value:n})}),c}function s(t,n,e){for(const o of t)if(o.style&&o.selectorText)try{const t=o.selectorText.split(",").map(t=>t.trim());for(const r of t)if(n.matches(r)){e.push(o);break}}catch(t){}else o.cssRules&&s(Array.from(o.cssRules),n,e)}function c(t,n){const e=n.trim(),o={position:["static"],float:["none"],clear:["none"],margin:["0px"],"margin-top":["0px"],"margin-right":["0px"],"margin-bottom":["0px"],"margin-left":["0px"],padding:["0px"],"padding-top":["0px"],"padding-right":["0px"],"padding-bottom":["0px"],"padding-left":["0px"],border:["none","0px none","medium none"],"border-top":["none","0px none"],"border-right":["none","0px none"],"border-bottom":["none","0px none"],"border-left":["none","0px none"],"border-radius":["0px"],background:["rgba(0, 0, 0, 0)","transparent","none"],"background-color":["rgba(0, 0, 0, 0)","transparent"],"background-image":["none"],opacity:["1"],"z-index":["auto"],transform:["none"],transition:["all 0s ease 0s","none"],animation:["none"],"box-shadow":["none"],"text-shadow":["none"],overflow:["visible"],"overflow-x":["visible"],"overflow-y":["visible"],visibility:["visible"],cursor:["auto"],"pointer-events":["auto"]};return o[t]?o[t].includes(e):!!/^0(px|em|rem|%)?$/.test(e)}function l(t){const n=new Map,e=[];t.forEach(({prop:t,value:e})=>{n.set(t,e)});const o=new Set;function r(...t){return t.every(n=>n===t[0])}function i(t){const[n,e,o,i]=t;return r(n,e,o,i)?n:n===o&&e===i?`${n} ${e}`:e===i?`${n} ${e} ${o}`:`${n} ${e} ${o} ${i}`}return t.forEach(({prop:t,value:a})=>{if(!o.has(t)&&!c(t,a)){if("margin-top"===t&&n.has("margin-right")&&n.has("margin-bottom")&&n.has("margin-left")){const t=i([n.get("margin-top"),n.get("margin-right"),n.get("margin-bottom"),n.get("margin-left")]);return c("margin",t)||e.push({prop:"margin",value:t}),o.add("margin-top"),o.add("margin-right"),o.add("margin-bottom"),void o.add("margin-left")}if("padding-top"===t&&n.has("padding-right")&&n.has("padding-bottom")&&n.has("padding-left")){const t=i([n.get("padding-top"),n.get("padding-right"),n.get("padding-bottom"),n.get("padding-left")]);return c("padding",t)||e.push({prop:"padding",value:t}),o.add("padding-top"),o.add("padding-right"),o.add("padding-bottom"),void o.add("padding-left")}if("border-top-left-radius"===t&&n.has("border-top-right-radius")&&n.has("border-bottom-right-radius")&&n.has("border-bottom-left-radius")){const t=n.get("border-top-left-radius"),i=n.get("border-top-right-radius"),a=n.get("border-bottom-right-radius"),s=n.get("border-bottom-left-radius");return r(t,i,a,s)?c("border-radius",t)||e.push({prop:"border-radius",value:t}):e.push({prop:"border-radius",value:`${t} ${i} ${a} ${s}`}),o.add("border-top-left-radius"),o.add("border-top-right-radius"),o.add("border-bottom-right-radius"),void o.add("border-bottom-left-radius")}if("border-top-width"===t&&n.has("border-top-style")&&n.has("border-top-color")){const t=n.get("border-top-width"),r=n.get("border-top-style"),i=n.get("border-top-color");if(n.get("border-right-width")===t&&n.get("border-bottom-width")===t&&n.get("border-left-width")===t&&n.get("border-right-style")===r&&n.get("border-bottom-style")===r&&n.get("border-left-style")===r&&n.get("border-right-color")===i&&n.get("border-bottom-color")===i&&n.get("border-left-color")===i&&"none"!==r)return e.push({prop:"border",value:`${t} ${r} ${i}`}),o.add("border-top-width"),o.add("border-right-width"),o.add("border-bottom-width"),o.add("border-left-width"),o.add("border-top-style"),o.add("border-right-style"),o.add("border-bottom-style"),o.add("border-left-style"),o.add("border-top-color"),o.add("border-right-color"),o.add("border-bottom-color"),o.add("border-left-color"),o.add("border-image-source"),o.add("border-image-slice"),o.add("border-image-width"),o.add("border-image-outset"),void o.add("border-image-repeat")}if("background-color"===t&&"none"===n.get("background-image")&&"repeat"===n.get("background-repeat")&&"scroll"===n.get("background-attachment")&&"0%"===n.get("background-position-x")&&"0%"===n.get("background-position-y"))return e.push({prop:"background",value:a}),o.add("background-color"),o.add("background-image"),o.add("background-repeat"),o.add("background-attachment"),o.add("background-position"),o.add("background-position-x"),o.add("background-position-y"),o.add("background-size"),o.add("background-origin"),void o.add("background-clip");o.has(t)||(!t.startsWith("background-")||"background-position-x"!==t&&"background-position-y"!==t&&"background-repeat"!==t&&"background-attachment"!==t&&"background-origin"!==t&&"background-clip"!==t&&"background-size"!==t||"none"!==n.get("background-image")?t.startsWith("border-image-")&&"none"===n.get("border-image-source")?o.add(t):(o.add(t),e.push({prop:t,value:a})):o.add(t))}}),e}function p(t){let n=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");let e=0;const o=[];function r(t){const n=`\0${e++}\0`;return o.push({marker:n,html:t}),n}const i=n.split("\n").map(t=>/^[^:]*\{/.test(t)?t.replace(/^([^{]+)(\{.*)$/,(t,n,e)=>r(`<span style="color: #fbbf24; font-weight: 600;">${n}</span>`)+e.replace(/\{/g,()=>r('<span style="color: #f87171; font-weight: bold;">{</span>'))):/^\s*\}/.test(t)?t.replace(/\}/g,()=>r('<span style="color: #f87171; font-weight: bold;">}</span>')):/:/.test(t)?t.replace(/^(\s+)([a-zA-Z-]+)(\s*):\s*([^;]+)(;?)(.*)$/,(t,n,e,o,i,a,s)=>{let c=i;c=c.replace(/(rgba?\([^)]+\))/gi,t=>r(`<span style="color: #a78bfa; font-weight: 600;">${t}</span>`)),c=c.replace(/(#[0-9a-fA-F]{3,8})\b/g,t=>r(`<span style="color: #a78bfa; font-weight: 600;">${t}</span>`)),c=c.replace(/\b(\d+(?:\.\d+)?)(px|em|rem|%|vh|vw|deg|s|ms|fr)\b/g,t=>r(`<span style="color: #fb923c;">${t}</span>`)),c=c.replace(/!important\b/g,t=>r(`<span style="color: #ef4444; font-weight: 600;">${t}</span>`));return`${n}${r(`<span style="color: #60a5fa;">${e}</span>`)}${o}: ${r(`<span style="color: #34d399;">${c}</span>`)}${a}${s}`}):t);return n=i.join("\n"),o.forEach(({marker:t,html:e})=>{n=n.replace(t,e)}),n}function d(t){let n="";const e=i(t,r.settings.selectorMode),o=l(a(t,!1));n+=`${e} {\n`,o.forEach(({prop:t,value:e})=>{n+=`  ${t}: ${e};\n`}),n+="}\n";const s=t.querySelectorAll("*"),c=new Map,p=Array.from(s).slice(0,200);return s.length>200&&(n+=`\n/* Warning: Only showing first 200 of ${s.length} child elements */\n`),p.forEach(t=>{const e=i(t,r.settings.selectorMode),o=l(a(t,!1));if(o.length>0){const t=`${e}::${o.map(({prop:t,value:n})=>`${t}:${n}`).sort().join(";")}`;c.has(t)||(c.set(t,!0),n+=`\n${e} {\n`,o.forEach(({prop:t,value:e})=>{n+=`  ${t}: ${e};\n`}),n+="}\n")}}),n}function u(t,n=!0){let e;if(n)e=t.outerHTML;else{e=t.cloneNode(!1).outerHTML.replace("></",">…</")}return function(t){let n="",e=0;const o="  ";return t.split(/(<[^>]+>)/g).forEach(t=>{t.trim()&&(t.startsWith("</")?(e=Math.max(0,e-1),n+=o.repeat(e)+t+"\n"):t.startsWith("<")?(n+=o.repeat(e)+t+"\n",t.endsWith("/>")||t.startsWith("</")||t.startsWith("<!")||e++):n+=o.repeat(e)+t.trim()+"\n")}),n.trim()}(e)}async function m(t,n=null){try{await navigator.clipboard.writeText(t),g(n||o("notificationCopied"))}catch(t){console.error("Failed to copy:",t),g(o("Failed to copy"),"error")}}function g(t,n="success"){const e=document.createElement("div");e.textContent=t,e.style.cssText=`\n      position: fixed !important;\n      top: 20px !important;\n      right: 20px !important;\n      background: ${"error"===n?"#ef4444":"#10b981"} !important;\n      color: white !important;\n      padding: 12px 24px !important;\n      border-radius: 6px !important;\n      z-index: 2147483647 !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      font-size: 14px !important;\n      box-shadow: 0 4px 6px rgba(0,0,0,0.3) !important;\n      animation: cssScannerSlideIn 0.3s ease !important;\n    `,document.body.appendChild(e),setTimeout(()=>{e.style.animation="cssScannerSlideOut 0.3s ease",setTimeout(()=>e.remove(),300)},2e3)}function b(){const t=document.getElementById("css-scanner-live-edit");t&&(t.remove(),g("Live CSS reset!"))}function h(){const t=document.createElement("div");t.id="css-scanner-block",t.innerHTML=`\n      <div class="inspector-header">\n        <div class="inspector-title">\n          <span class="element-tag"></span>\n          <span class="element-size"></span>\n        </div>\n        <div class="inspector-actions">\n          <button class="btn-guide" title="${o("btnGuide")}">?</button>\n          <button class="btn-settings" title="${o("btnSettings")}">⚙</button>\n          <button class="btn-close" title="${o("btnClose")}">×</button>\n        </div>\n      </div>\n\n      <div class="inspector-breadcrumb"></div>\n\n      <div class="inspector-tabs">\n        <button class="tab-btn scanner-tab active" data-tab="css">${o("tabCSS")}</button>\n        <button class="tab-btn scanner-tab" data-tab="html">${o("tabHTML")}</button>\n        <button class="tab-btn scanner-tab" data-tab="source">${o("tabSource")}</button>\n        <button class="tab-btn scanner-tab" data-tab="editor">${o("tabEditor")}</button>\n      </div>\n\n      <div class="inspector-toolbar">\n        <button class="btn-copy-code btn-copy">${o("btnCopy")}</button>\n        <button class="btn-codepen">${o("btnCodePen")}</button>\n        <button class="btn-pin">${o("btnPin")}</button>\n      </div>\n\n      <div class="inspector-content">\n        <div class="tab-content active" data-tab="css">\n          <div class="css-options">\n            <label for="include-children-css">\n              <input type="checkbox" id="include-children-css">\n              ${o("optionIncludeChildren")}\n            </label>\n          </div>\n          <pre class="css-code"></pre>\n        </div>\n\n        <div class="tab-content" data-tab="html">\n          <div class="html-options">\n            <label for="include-children-html">\n              <input type="checkbox" id="include-children-html" checked>\n              ${o("optionIncludeChildren")}\n            </label>\n          </div>\n          <pre class="html-code"></pre>\n        </div>\n\n        <div class="tab-content" data-tab="source">\n          <div class="source-list"></div>\n        </div>\n\n        <div class="tab-content" data-tab="editor">\n          <div class="editor-controls">\n            <button class="btn-apply-css btn-apply">${o("btnApply")}</button>\n            <button class="btn-reset-css btn-reset">${o("btnReset")}</button>\n          </div>\n          <div class="editor-wrapper">\n            <pre class="editor-highlight" aria-hidden="true"></pre>\n            <textarea class="css-editor" placeholder="${o("tabEditor")}..." spellcheck="false"></textarea>\n          </div>\n        </div>\n      </div>\n\n      <div class="inspector-footer">\n        <span>${o("footerSpace")} ${o("footerTo")} ${r.frozen?o("footerUnfreeze"):o("footerFreeze")} • ${o("footerBackspace")} ${o("footerTo")} ${r.frozen?o("footerFreeze"):o("footerUnfreeze")} • ${o("footerEsc")} ${o("footerTo")} ${o("footerClose")}</span>\n      </div>\n    `,function(){if(document.getElementById("css-scanner-styles"))return;const t=document.createElement("style");t.id="css-scanner-styles",t.textContent="\n      @keyframes cssScannerSlideIn {\n        from { transform: translateX(100%); opacity: 0; }\n        to { transform: translateX(0); opacity: 1; }\n      }\n\n      @keyframes cssScannerSlideOut {\n        from { transform: translateX(0); opacity: 1; }\n        to { transform: translateX(100%); opacity: 0; }\n      }\n\n      #css-scanner-block {\n        position: fixed !important;\n        display: flex !important;\n        visibility: visible !important;\n        opacity: 1 !important;\n        background: #1f2937 !important;\n        color: #f3f4f6 !important;\n        border: 2px solid #3b82f6 !important;\n        border-radius: 8px !important;\n        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5) !important;\n        z-index: 2147483647 !important;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Courier New', monospace !important;\n        font-size: 13px !important;\n        line-height: 1.5 !important;\n        width: 600px !important;\n        max-height: 80vh !important;\n        flex-direction: column !important;\n        overflow: hidden !important;\n      }\n\n      #css-scanner-block * {\n        box-sizing: border-box !important;\n      }\n\n      .inspector-header {\n        background: #111827 !important;\n        padding: 12px 16px !important;\n        border-bottom: 1px solid #374151 !important;\n        display: flex !important;\n        justify-content: space-between !important;\n        align-items: center !important;\n        cursor: move !important;\n      }\n\n      .inspector-title {\n        display: flex !important;\n        flex-direction: column !important;\n      }\n\n      .element-tag {\n        color: #60a5fa !important;\n        font-weight: 600 !important;\n        font-size: 14px !important;\n      }\n\n      .element-size {\n        color: #9ca3af !important;\n        font-size: 11px !important;\n        margin-top: 2px !important;\n      }\n\n      .inspector-actions {\n        display: flex !important;\n        gap: 8px !important;\n      }\n\n      .inspector-actions button {\n        background: transparent !important;\n        border: 1px solid #4b5563 !important;\n        color: #f3f4f6 !important;\n        padding: 4px 8px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 16px !important;\n        line-height: 1 !important;\n      }\n\n      .inspector-actions button:hover {\n        background: #374151 !important;\n      }\n\n      .inspector-breadcrumb {\n        background: #111827 !important;\n        padding: 8px 16px !important;\n        border-bottom: 1px solid #374151 !important;\n        font-size: 11px !important;\n        color: #9ca3af !important;\n        overflow-x: auto !important;\n        overflow-y: hidden !important;\n        white-space: nowrap !important;\n        max-height: 32px !important;\n        scrollbar-width: thin !important;\n        scrollbar-color: #4b5563 #111827 !important;\n      }\n\n      .inspector-breadcrumb::-webkit-scrollbar {\n        height: 4px !important;\n      }\n\n      .inspector-breadcrumb::-webkit-scrollbar-track {\n        background: #111827 !important;\n      }\n\n      .inspector-breadcrumb::-webkit-scrollbar-thumb {\n        background: #4b5563 !important;\n        border-radius: 2px !important;\n      }\n\n      .inspector-breadcrumb::-webkit-scrollbar-thumb:hover {\n        background: #6b7280 !important;\n      }\n\n      .breadcrumb-item {\n        cursor: pointer !important;\n        color: #60a5fa !important;\n      }\n\n      .breadcrumb-item:hover {\n        text-decoration: underline !important;\n      }\n\n      .breadcrumb-ellipsis {\n        color: #fbbf24 !important;\n        font-weight: bold !important;\n        cursor: help !important;\n        padding: 0 4px !important;\n      }\n\n      .inspector-tabs {\n        background: #111827 !important;\n        display: block !important;\n        border-bottom: 1px solid #374151 !important;\n        padding: 0 16px !important;\n      }\n\n      .tab-btn {\n        background: transparent !important;\n        border: none !important;\n        color: #9ca3af !important;\n        padding: 10px 16px !important;\n        cursor: pointer !important;\n        font-size: 13px !important;\n        border-bottom: 2px solid transparent !important;\n        margin-bottom: -1px !important;\n        margin-right: 0 !important;\n        white-space: nowrap !important;\n        display: inline-block !important;\n        vertical-align: bottom !important;\n        float: none !important;\n      }\n\n      .tab-btn:hover {\n        color: #f3f4f6 !important;\n      }\n\n      .tab-btn.active {\n        color: #60a5fa !important;\n        border-bottom-color: #60a5fa !important;\n      }\n\n      .inspector-toolbar {\n        background: #1f2937 !important;\n        padding: 10px 16px !important;\n        border-bottom: 1px solid #374151 !important;\n        display: flex !important;\n        gap: 8px !important;\n      }\n\n      .inspector-toolbar button {\n        background: #3b82f6 !important;\n        border: none !important;\n        color: white !important;\n        padding: 6px 12px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 12px !important;\n        font-weight: 500 !important;\n      }\n\n      .inspector-toolbar button:hover {\n        background: #2563eb !important;\n      }\n\n      .btn-pin {\n        background: #6b7280 !important;\n      }\n\n      .btn-pin:hover {\n        background: #4b5563 !important;\n      }\n\n      .inspector-content {\n        flex: 1 !important;\n        overflow-y: auto !important;\n        background: #1f2937 !important;\n        max-height: 50vh !important;\n      }\n\n      .tab-content {\n        display: none !important;\n      }\n\n      .tab-content.active {\n        display: block !important;\n      }\n\n      .css-code, .html-code {\n        padding: 16px !important;\n        margin: 0 !important;\n        color: #f3f4f6 !important;\n        font-family: 'Courier New', Courier, monospace !important;\n        font-size: 12px !important;\n        line-height: 1.6 !important;\n        background: transparent !important;\n        white-space: pre-wrap !important;\n        word-wrap: break-word !important;\n        user-select: text !important;\n        cursor: text !important;\n      }\n\n      .css-options,\n      .html-options {\n        padding: 12px 16px !important;\n        background: #111827 !important;\n        border-bottom: 1px solid #374151 !important;\n      }\n\n      .css-options label,\n      .html-options label {\n        display: flex !important;\n        align-items: center !important;\n        gap: 8px !important;\n        color: #f3f4f6 !important;\n        font-size: 12px !important;\n        cursor: pointer !important;\n      }\n\n      .css-options input[type=\"checkbox\"],\n      .html-options input[type=\"checkbox\"] {\n        cursor: pointer !important;\n      }\n\n      .source-list {\n        min-height: 200px !important;\n      }\n\n      .editor-controls {\n        padding: 12px 16px !important;\n        background: #111827 !important;\n        border-bottom: 1px solid #374151 !important;\n        display: flex !important;\n        gap: 8px !important;\n      }\n\n      .editor-controls button {\n        background: #10b981 !important;\n        border: none !important;\n        color: white !important;\n        padding: 6px 12px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 12px !important;\n        font-weight: 500 !important;\n      }\n\n      .editor-controls button:hover {\n        background: #059669 !important;\n      }\n\n      .btn-reset-css {\n        background: #ef4444 !important;\n      }\n\n      .btn-reset-css:hover {\n        background: #dc2626 !important;\n      }\n\n      .editor-wrapper {\n        position: relative !important;\n        width: 100% !important;\n        overflow: hidden !important;\n        border-radius: 4px !important;\n      }\n\n      .editor-highlight {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        min-height: 300px !important;\n        padding: 16px !important;\n        margin: 0 !important;\n        background: #111827 !important;\n        color: transparent !important;\n        font-family: 'Courier New', Courier, monospace !important;\n        font-size: 12px !important;\n        line-height: 1.6 !important;\n        white-space: pre-wrap !important;\n        word-wrap: break-word !important;\n        pointer-events: none !important;\n        z-index: 1 !important;\n        overflow: hidden !important;\n      }\n\n      .css-editor {\n        position: relative !important;\n        width: 100% !important;\n        min-height: 300px !important;\n        padding: 16px !important;\n        background: transparent !important;\n        color: #f3f4f6 !important;\n        border: none !important;\n        font-family: 'Courier New', Courier, monospace !important;\n        font-size: 12px !important;\n        line-height: 1.6 !important;\n        resize: vertical !important;\n        z-index: 2 !important;\n        caret-color: #f3f4f6 !important;\n      }\n\n      .css-editor:focus {\n        outline: none !important;\n      }\n\n      .inspector-footer {\n        background: #111827 !important;\n        padding: 8px 16px !important;\n        border-top: 1px solid #374151 !important;\n        font-size: 11px !important;\n        color: #9ca3af !important;\n        text-align: center !important;\n      }\n\n      #css-scanner-options .options-header {\n        background: #111827 !important;\n        padding: 16px 20px !important;\n        border-bottom: 1px solid #374151 !important;\n        display: flex !important;\n        justify-content: space-between !important;\n        align-items: center !important;\n      }\n\n      #css-scanner-options h3 {\n        margin: 0 !important;\n        color: #f3f4f6 !important;\n        font-size: 18px !important;\n        font-weight: 600 !important;\n      }\n\n      .btn-close-options {\n        background: transparent !important;\n        border: 1px solid #4b5563 !important;\n        color: #f3f4f6 !important;\n        width: 28px !important;\n        height: 28px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 20px !important;\n        line-height: 1 !important;\n        display: flex !important;\n        align-items: center !important;\n        justify-content: center !important;\n      }\n\n      .btn-close-options:hover {\n        background: #374151 !important;\n      }\n\n      #css-scanner-options .options-content {\n        padding: 20px !important;\n      }\n\n      .options-section {\n        margin-bottom: 24px !important;\n      }\n\n      .options-section h4 {\n        margin: 0 0 12px 0 !important;\n        color: #60a5fa !important;\n        font-size: 13px !important;\n        font-weight: 600 !important;\n      }\n\n      .options-section label {\n        display: flex !important;\n        align-items: center !important;\n        gap: 8px !important;\n        margin-bottom: 8px !important;\n        color: #f3f4f6 !important;\n        font-size: 13px !important;\n        cursor: pointer !important;\n      }\n\n      .options-section input[type=\"checkbox\"],\n      .options-section input[type=\"radio\"] {\n        cursor: pointer !important;\n      }\n\n      #css-scanner-options .options-footer {\n        background: #111827 !important;\n        padding: 16px 20px !important;\n        border-top: 1px solid #374151 !important;\n        text-align: right !important;\n      }\n\n      .btn-save-options {\n        background: #3b82f6 !important;\n        border: none !important;\n        color: white !important;\n        padding: 10px 20px !important;\n        border-radius: 4px !important;\n        cursor: pointer !important;\n        font-size: 13px !important;\n        font-weight: 600 !important;\n      }\n\n      .btn-save-options:hover {\n        background: #2563eb !important;\n      }\n    ",document.head.appendChild(t)}();t.querySelectorAll(".tab-btn").forEach(t=>{t.addEventListener("click",n=>{n.stopPropagation(),x(t.dataset.tab)})});t.querySelector(".btn-close").addEventListener("click",t=>{t.stopPropagation(),M()});t.querySelector(".btn-guide").addEventListener("click",t=>{t.stopPropagation(),f()});t.querySelector(".btn-settings").addEventListener("click",t=>{t.stopPropagation(),function(){r.optionsPanel||(r.optionsPanel=y());"none"===r.optionsPanel.style.display?(v(r.optionsPanel),r.optionsPanel.style.display="block"):r.optionsPanel.style.display="none"}()});t.querySelector(".btn-copy-code").addEventListener("click",t=>{t.stopPropagation(),function(){switch(r.currentTab){case"css":C();break;case"html":m(r.displayedHTML,"HTML copied!");break;case"source":!function(){let t="CSS Sources:\n\n";r.sourceFiles.forEach(({url:n,ruleCount:e})=>{t+=`${n} (${e} rules)\n`}),m(t,"Sources copied!")}();break;case"editor":m(r.inspectorBlock.querySelector(".css-editor").value,"Editor code copied!")}}()});t.querySelector(".btn-codepen").addEventListener("click",t=>{t.stopPropagation(),function(){const t=u(r.currentElement,r.settings.includeChildren);let n="";if(r.settings.includeChildren)n=d(r.currentElement);else{const t=r.displayedCSS.map(({prop:t,value:n})=>`  ${t}: ${n};`).join("\n");n=`${i(r.currentElement,r.settings.selectorMode)} {\n${t}\n}`}const e={title:"CSS Scanner Pro - Export by Simon Adjatan",html:t,css:n,js:"",editors:"110"},o=document.createElement("form");o.action="https://codepen.io/pen/define",o.method="POST",o.target="_blank";const a=document.createElement("input");a.type="hidden",a.name="data",a.value=JSON.stringify(e),o.appendChild(a),document.body.appendChild(o),o.submit(),document.body.removeChild(o),g("Opening in CodePen with "+(r.settings.includeChildren?"full component CSS":"element CSS")+"...")}()});t.querySelector(".btn-pin").addEventListener("click",t=>{t.stopPropagation(),L()});t.querySelector(".btn-apply-css").addEventListener("click",n=>{n.stopPropagation();!function(t){let n=document.getElementById("css-scanner-live-edit");n||(n=document.createElement("style"),n.id="css-scanner-live-edit",document.head.appendChild(n)),n.textContent=t,g("Live CSS applied!")}(t.querySelector(".css-editor").value)});t.querySelector(".btn-reset-css").addEventListener("click",n=>{n.stopPropagation(),b();const e=t.querySelector(".css-editor"),o=t.querySelector(".editor-highlight");e.value=r.originalCSS,o&&(o.innerHTML=p(r.originalCSS))});const n=t.querySelector(".css-editor"),e=t.querySelector(".editor-highlight");n.addEventListener("input",t=>{e&&(e.innerHTML=p(t.target.value))}),n.addEventListener("scroll",t=>{e&&(e.scrollTop=t.target.scrollTop,e.scrollLeft=t.target.scrollLeft)});const a=t.querySelector("#include-children-html");a.addEventListener("change",t=>{t.stopPropagation(),r.settings.includeChildrenHTML=t.target.checked,r.currentElement&&S()});const s=t.querySelector("#include-children-css");s.addEventListener("change",t=>{t.stopPropagation(),r.settings.includeChildren=t.target.checked,r.currentElement&&k()}),s.checked=r.settings.includeChildren,a.checked=r.settings.includeChildrenHTML;let c=!1,l=0,h=0,$=0,w=0;const E=t.querySelector(".inspector-header");return E.style.cursor="move",E.addEventListener("mousedown",t=>{t.target.closest(".inspector-actions")||(c=!0,$=t.clientX-l,w=t.clientY-h)}),document.addEventListener("mousemove",n=>{c&&(n.preventDefault(),l=n.clientX-$,h=n.clientY-w,t.style.transform=`translate(${l}px, ${h}px)`)}),document.addEventListener("mouseup",()=>{c=!1}),document.body.appendChild(t),t}function f(){let t=document.getElementById("css-scanner-guide-overlay");if(t){t.style.display="block";const n=t.querySelector(".guide-close"),e=t.querySelector(".guide-backdrop"),o=t.querySelector(".guide-panel");if(n){console.log("Reattaching close button, element:",n);const e=n=>{n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),console.log("Close button activated (reattached)"),t.style.display="none"};n.onclick=e,n.onmousedown=e,n.addEventListener("click",e,!0),n.style.cursor="pointer",console.log("Close button handlers set (onclick, onmousedown, addEventListener)")}else console.error("Close button not found!");return e&&(e.onclick=n=>{console.log("Backdrop clicked (reattached)"),t.style.display="none"}),void(o&&(o.onclick=t=>{t.stopPropagation(),console.log("Panel clicked - not closing (reattached)")}))}const n=navigator.platform.toUpperCase().indexOf("MAC")>=0;t=document.createElement("div"),t.id="css-scanner-guide-overlay";const e=n?"Cmd+Shift+S":"Ctrl+Shift+S";t.innerHTML=`\n      <div class="guide-backdrop"></div>\n      <div class="guide-panel">\n        <div class="guide-header">\n          <h2>${o("guideTitle")}</h2>\n          <button class="guide-close">&times;</button>\n        </div>\n        <div class="guide-content">\n          <div class="guide-section">\n            <h3>${o("guideQuickStart")}</h3>\n            <div class="guide-shortcuts">\n              <div class="guide-shortcut">\n                <span>${o("shortcutActivateScanner")}</span>\n                <kbd>Ctrl+Shift+S</kbd>\n              </div>\n              <div class="guide-shortcut">\n                <span>${o("shortcutToggleGrid")}</span>\n                <kbd>Ctrl+Shift+G</kbd>\n              </div>\n              <div class="guide-shortcut">\n                <span>${o("shortcutScanParent")}</span>\n                <kbd>Ctrl+Shift+E</kbd>\n              </div>\n            </div>\n          </div>\n\n          <div class="guide-section">\n            <h3>${o("guideHowToUse")}</h3>\n            <ol class="guide-steps">\n              <li>${o("guideStep1",e)}</li>\n              <li>${o("guideStep2")}</li>\n              <li>${o("guideStep3",["<strong>"+o("tabCSS")+"</strong>","<strong>"+o("tabHTML")+"</strong>","<strong>"+o("tabSource")+"</strong>","<strong>"+o("tabEditor")+"</strong>"])}</li>\n              <li>${o("guideStep4","<strong>"+o("btnCopy")+"</strong>")}</li>\n              <li>${o("guideStep5",["<kbd>Space</kbd>","<kbd>Esc</kbd>"])}</li>\n            </ol>\n          </div>\n\n          <div class="guide-section">\n            <h3>${o("guideFeatures")}</h3>\n            <ul class="guide-features">\n              <li>${o("featureSyntaxHighlighting")}</li>\n              <li>${o("featureIncludeChildren")}</li>\n              <li>${o("featureLiveEditor")}</li>\n              <li>${o("featureCodePenExport")}</li>\n              <li>${o("featureOptimizedCSS")}</li>\n            </ul>\n          </div>\n\n          <div class="guide-tip">\n            <strong>${o("guideProTip")}</strong> ${o("proTipMessage")}\n          </div>\n        </div>\n      </div>\n    `;const r=document.createElement("style");r.textContent="\n      #css-scanner-guide-overlay {\n        position: fixed !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100vw !important;\n        height: 100vh !important;\n        z-index: 2147483647 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-backdrop {\n        position: absolute !important;\n        top: 0 !important;\n        left: 0 !important;\n        width: 100% !important;\n        height: 100% !important;\n        background: rgba(0, 0, 0, 0.7) !important;\n        cursor: pointer !important;\n        z-index: 1 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-panel {\n        position: absolute !important;\n        top: 50% !important;\n        left: 50% !important;\n        transform: translate(-50%, -50%) !important;\n        width: 90% !important;\n        max-width: 600px !important;\n        max-height: 80vh !important;\n        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%) !important;\n        border-radius: 12px !important;\n        box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5) !important;\n        overflow: hidden !important;\n        display: flex !important;\n        flex-direction: column !important;\n        z-index: 2 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-header {\n        background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%) !important;\n        padding: 20px !important;\n        display: flex !important;\n        justify-content: space-between !important;\n        align-items: center !important;\n        position: relative !important;\n        z-index: 3 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-header h2 {\n        margin: 0 !important;\n        color: white !important;\n        font-size: 20px !important;\n        font-weight: 700 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-close {\n        background: rgba(255, 255, 255, 0.1) !important;\n        border: none !important;\n        color: white !important;\n        width: 32px !important;\n        height: 32px !important;\n        border-radius: 6px !important;\n        font-size: 24px !important;\n        cursor: pointer !important;\n        transition: all 0.2s !important;\n        display: flex !important;\n        align-items: center !important;\n        justify-content: center !important;\n        line-height: 1 !important;\n        pointer-events: auto !important;\n        position: relative !important;\n        z-index: 10 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-close:hover {\n        background: rgba(255, 255, 255, 0.2) !important;\n        transform: scale(1.1) !important;\n      }\n\n      #css-scanner-guide-overlay .guide-content {\n        padding: 24px !important;\n        overflow-y: auto !important;\n        color: #f1f5f9 !important;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n      }\n\n      #css-scanner-guide-overlay .guide-section {\n        margin-bottom: 24px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-section h3 {\n        color: #60a5fa !important;\n        font-size: 16px !important;\n        font-weight: 600 !important;\n        margin: 0 0 12px 0 !important;\n        border-left: 4px solid #3b82f6 !important;\n        padding-left: 12px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-shortcuts {\n        display: flex !important;\n        flex-direction: column !important;\n        gap: 8px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-shortcut {\n        display: flex !important;\n        justify-content: space-between !important;\n        align-items: center !important;\n        padding: 10px 12px !important;\n        background: #1e293b !important;\n        border: 1px solid #334155 !important;\n        border-radius: 6px !important;\n        font-size: 13px !important;\n        color: #cbd5e1 !important;\n      }\n\n      #css-scanner-guide-overlay kbd {\n        background: #0f172a !important;\n        padding: 4px 10px !important;\n        border-radius: 4px !important;\n        font-family: 'Courier New', monospace !important;\n        font-size: 11px !important;\n        color: #60a5fa !important;\n        border: 1px solid #1e293b !important;\n        font-weight: 600 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-steps,\n      #css-scanner-guide-overlay .guide-features {\n        margin: 0 !important;\n        padding-left: 24px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-steps li,\n      #css-scanner-guide-overlay .guide-features li {\n        color: #cbd5e1 !important;\n        font-size: 13px !important;\n        line-height: 1.6 !important;\n        margin-bottom: 8px !important;\n      }\n\n      #css-scanner-guide-overlay .guide-tip {\n        background: #0f172a !important;\n        border-left: 3px solid #fbbf24 !important;\n        padding: 12px !important;\n        border-radius: 4px !important;\n        font-size: 13px !important;\n        color: #e2e8f0 !important;\n        line-height: 1.6 !important;\n      }\n\n      #css-scanner-guide-overlay .guide-tip strong {\n        color: #fbbf24 !important;\n      }\n    ",t.appendChild(r),document.body.appendChild(t);const i=t.querySelector(".guide-close"),a=t.querySelector(".guide-backdrop"),s=t.querySelector(".guide-panel"),c=()=>{console.log("Close guide called"),t.style.display="none"};if(i){console.log("Initial close button setup, element:",i);const t=t=>{t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),console.log("Close button activated (initial)"),c()};i.onclick=t,i.onmousedown=t,i.addEventListener("click",t,!0),i.style.cursor="pointer",console.log("Initial close button handlers set (onclick, onmousedown, addEventListener)")}else console.error("Close button not found during initial setup!");a&&(a.onclick=t=>{console.log("Backdrop clicked"),c()}),s&&(s.onclick=t=>{t.stopPropagation(),console.log("Panel clicked - not closing")}),n&&t.querySelectorAll("kbd").forEach(t=>{t.textContent.includes("Ctrl")&&(t.textContent=t.textContent.replace("Ctrl","Cmd"))})}function y(){const i=document.createElement("div");i.id="css-scanner-options",i.innerHTML=`\n      <div class="options-header">\n        <h3>${o("settingsTitle")}</h3>\n        <button class="btn-close-options">×</button>\n      </div>\n\n      <div class="options-content">\n        <div class="options-section">\n          <h4>${o("settingsSectionOnClick")}</h4>\n          <label>\n            <input type="checkbox" id="opt-copy-on-click">\n            ${o("settingsOptionCopyOnClick")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-pin-on-space" checked>\n            ${o("settingsOptionPinOnSpace")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionChildCSS")}</h4>\n          <label>\n            <input type="radio" name="children-css" value="include">\n            ${o("settingsOptionIncludeChildren")}\n          </label>\n          <label>\n            <input type="radio" name="children-css" value="exclude" checked>\n            ${o("settingsOptionExcludeChildren")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionHTML")}</h4>\n          <label>\n            <input type="checkbox" id="opt-copy-html">\n            ${o("settingsOptionCopyHTML")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionDisplay")}</h4>\n          <label>\n            <input type="checkbox" id="opt-show-grid">\n            ${o("settingsOptionShowGrid")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-show-guidelines">\n            ${o("settingsOptionGuidelines")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionLanguage")}</h4>\n          <select id="opt-language" style="width: 100%; padding: 8px; background: #374151; color: #f3f4f6; border: 1px solid #4b5563; border-radius: 4px; font-size: 14px;">\n            <option value="auto">${o("settingsLanguageAuto")}</option>\n            <option value="en">English</option>\n            <option value="fr">Français (French)</option>\n            <option value="es">Español (Spanish)</option>\n            <option value="de">Deutsch (German)</option>\n          </select>\n          <p style="font-size: 12px; color: #9ca3af; margin-top: 4px; margin-bottom: 0;">\n            ${o("settingsLanguageHelp")}\n          </p>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionSelectors")}</h4>\n          <label>\n            <input type="radio" name="selector-mode" value="smart" checked>\n            ${o("settingsSelectorSmart")}\n          </label>\n          <label>\n            <input type="radio" name="selector-mode" value="original">\n            ${o("settingsSelectorOriginal")}\n          </label>\n          <label>\n            <input type="radio" name="selector-mode" value="none">\n            ${o("settingsSelectorNone")}\n          </label>\n          <label>\n            <input type="radio" name="selector-mode" value="truncated">\n            ${o("settingsSelectorTruncated")}\n          </label>\n        </div>\n\n        <div class="options-section">\n          <h4>${o("settingsSectionOther")}</h4>\n          <label>\n            <input type="checkbox" id="opt-ignore-inherited">\n            ${o("settingsOptionIgnoreInherited")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-ignore-vendor" checked>\n            ${o("settingsOptionIgnoreVendor")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-ignore-box-sizing">\n            ${o("settingsOptionIgnoreBoxSizing")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-convert-font-size">\n            ${o("settingsOptionConvertFontSize")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-nest-pseudo">\n            ${o("settingsOptionNestPseudo")}\n          </label>\n          <label>\n            <input type="checkbox" id="opt-convert-urls" checked>\n            ${o("settingsOptionConvertURLs")}\n          </label>\n        </div>\n      </div>\n\n      <div class="options-footer">\n        <button class="btn-save-options">${o("settingsSaveButton")}</button>\n      </div>\n    `,i.style.cssText="\n      display: none;\n      position: fixed !important;\n      top: 50% !important;\n      left: 50% !important;\n      transform: translate(-50%, -50%) !important;\n      background: #1f2937 !important;\n      color: #f3f4f6 !important;\n      padding: 0 !important;\n      border-radius: 8px !important;\n      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5) !important;\n      z-index: 2147483647 !important;\n      width: 500px !important;\n      max-height: 80vh !important;\n      overflow-y: auto !important;\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;\n    ";i.querySelector(".btn-close-options").addEventListener("click",()=>{i.style.display="none"});return i.querySelector(".btn-save-options").addEventListener("click",()=>{!async function(){const i=r.optionsPanel;r.settings.copyOnClick=i.querySelector("#opt-copy-on-click").checked,r.settings.pinOnSpace=i.querySelector("#opt-pin-on-space").checked,r.settings.copyHTMLWithCSS=i.querySelector("#opt-copy-html").checked,r.settings.showGrid=i.querySelector("#opt-show-grid").checked,r.settings.showGuidelines=i.querySelector("#opt-show-guidelines").checked,r.settings.ignoreInherited=i.querySelector("#opt-ignore-inherited").checked,r.settings.ignoreVendorPrefixes=i.querySelector("#opt-ignore-vendor").checked,r.settings.ignoreBoxSizing=i.querySelector("#opt-ignore-box-sizing").checked,r.settings.convertFontSizeToPx=i.querySelector("#opt-convert-font-size").checked,r.settings.nestPseudoClasses=i.querySelector("#opt-nest-pseudo").checked,r.settings.convertRelativeURLs=i.querySelector("#opt-convert-urls").checked;const a=i.querySelector('input[name="children-css"]:checked');r.settings.includeChildren="include"===a.value;const s=i.querySelector('input[name="selector-mode"]:checked');r.settings.selectorMode=s.value;const c=i.querySelector("#opt-language"),l=c?c.value:"auto",p=r.settings.language!==l;r.settings.language=l,p&&(n=l,"auto"!==l?await e(l):t={},r.active&&r.inspectorBlock&&function(){if(!r.inspectorBlock)return;r.inspectorBlock.querySelectorAll(".scanner-tab").forEach(t=>{const n=t.getAttribute("data-tab");"css"===n&&(t.textContent=o("tabCSS")),"html"===n&&(t.textContent=o("tabHTML")),"source"===n&&(t.textContent=o("tabSource")),"editor"===n&&(t.textContent=o("tabEditor"))});const t=r.inspectorBlock.querySelector(".btn-copy");t&&(t.textContent=o("btnCopy"));const n=r.inspectorBlock.querySelector(".btn-codepen");n&&(n.textContent=o("btnCodePen"));const e=r.inspectorBlock.querySelector(".btn-pin");e&&(e.textContent=r.frozen?o("btnUnpin"):o("btnPin"));const i=r.inspectorBlock.querySelector(".btn-apply");i&&(i.textContent=o("btnApply"));const a=r.inspectorBlock.querySelector(".btn-reset");a&&(a.textContent=o("btnReset"));const s=r.inspectorBlock.querySelector('label[for="include-children-css"]');if(s){const t=s.querySelector("input");s.innerHTML="",s.appendChild(t),s.appendChild(document.createTextNode(o("optionIncludeChildren")))}const c=r.inspectorBlock.querySelector('label[for="include-children-html"]');if(c){const t=c.querySelector("input");c.innerHTML="",c.appendChild(t),c.appendChild(document.createTextNode(o("optionIncludeChildren")))}z(),"css"===r.currentTab&&k();"html"===r.currentTab&&S();"source"===r.currentTab&&$();"editor"===r.currentTab&&w();if(r.optionsPanel){const t="none"!==r.optionsPanel.style.display;r.settings;r.optionsPanel.remove(),r.optionsPanel=y(),t&&(r.optionsPanel.style.display="flex")}const l=document.getElementById("css-scanner-guide-overlay");if(l){const t="none"!==l.style.display;l.remove(),t&&f()}}());"undefined"!=typeof chrome&&chrome.storage?chrome.storage.sync.set({cssScanner:r.settings},()=>{g(o("settingsSave")+"d!")}):(localStorage.setItem("cssScanner",JSON.stringify(r.settings)),g(o("settingsSave")+"d!"))}(),i.style.display="none"}),v(i),document.body.appendChild(i),i}function v(t){t.querySelector("#opt-copy-on-click").checked=r.settings.copyOnClick,t.querySelector("#opt-pin-on-space").checked=r.settings.pinOnSpace,t.querySelector("#opt-copy-html").checked=r.settings.copyHTMLWithCSS,t.querySelector("#opt-show-grid").checked=r.settings.showGrid,t.querySelector("#opt-show-guidelines").checked=r.settings.showGuidelines,t.querySelector("#opt-ignore-inherited").checked=r.settings.ignoreInherited,t.querySelector("#opt-ignore-vendor").checked=r.settings.ignoreVendorPrefixes,t.querySelector("#opt-ignore-box-sizing").checked=r.settings.ignoreBoxSizing,t.querySelector("#opt-convert-font-size").checked=r.settings.convertFontSizeToPx,t.querySelector("#opt-nest-pseudo").checked=r.settings.nestPseudoClasses,t.querySelector("#opt-convert-urls").checked=r.settings.convertRelativeURLs;const n=t.querySelector("#opt-language");n&&(n.value=r.settings.language||"auto");const e=r.settings.includeChildren?"include":"exclude";t.querySelector(`input[name="children-css"][value="${e}"]`).checked=!0;const o=t.querySelector(`input[name="selector-mode"][value="${r.settings.selectorMode}"]`);o&&(o.checked=!0)}function x(t){r.currentTab=t;r.inspectorBlock.querySelectorAll(".tab-btn").forEach(n=>{n.dataset.tab===t?n.classList.add("active"):n.classList.remove("active")});if(r.inspectorBlock.querySelectorAll(".tab-content").forEach(n=>{n.dataset.tab===t?n.classList.add("active"):n.classList.remove("active")}),r.currentElement)switch(t){case"css":k();break;case"html":S();break;case"source":$();break;case"editor":w()}}function k(){const t=r.inspectorBlock.querySelector(".css-code");if(r.settings.includeChildren){const n=d(r.currentElement);t.innerHTML=p(n);const e=a(r.currentElement,!1);r.displayedCSS=l(e)}else{const n=l(a(r.currentElement,!1));r.displayedCSS=n;let e="";n.forEach(({prop:t,value:n})=>{e+=`  ${t}: ${n};\n`});const o=`${i(r.currentElement,r.settings.selectorMode)} {\n${e}}`;t.innerHTML=p(o)}}function S(){const t=r.inspectorBlock.querySelector(".html-code"),n=r.settings.includeChildrenHTML,e=u(r.currentElement,n);r.displayedHTML=e,t.innerHTML=function(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").split("\n").map(t=>{if(!t.trim())return t;let n=t;return n=n.replace(/&lt;!--(.*?)--&gt;/g,'<span style="color: #6b7280; font-style: italic;">&lt;!--$1--&gt;</span>'),n.includes("&lt;!--")||(n=n.replace(/&lt;\/(\w[\w-]*)&gt;/g,'&lt;<span style="color: #f87171;">/</span><span style="color: #fbbf24; font-weight: 600;">$1</span><span style="color: #f87171;">&gt;</span>'),n=n.replace(/&lt;(\w[\w-]*)((?:\s+[\w-]+(?:=&quot;[^&"]*&quot;)?)*)\s*(\/?)&gt;/g,(t,n,e,o)=>{let r='&lt;<span style="color: #fbbf24; font-weight: 600;">'+n+"</span>";return e&&(r+=e.replace(/\s+([\w-]+)(?:=(&quot;[^&"]*&quot;))?/g,(t,n,e)=>{let o=' <span style="color: #60a5fa;">'+n+"</span>";return e&&(o+='=<span style="color: #34d399;">'+e+"</span>"),o})),r+=o?'<span style="color: #f87171;">/&gt;</span>':'<span style="color: #f87171;">&gt;</span>',r})),n}).join("\n")}(e)}function $(){const t=r.inspectorBlock.querySelector(".source-list"),n=function(t){const n=[],e=new Set;try{for(const o of document.styleSheets)try{const r=Array.from(o.cssRules||[]).filter(n=>{try{if(n.selectorText)return t.matches(n.selectorText)}catch(t){return!1}return!1});if(r.length>0){const t=o.href||"inline styles";e.has(t)||(e.add(t),n.push({url:t,ruleCount:r.length}))}}catch(t){o.href&&!e.has(o.href)&&(e.add(o.href),n.push({url:o.href,ruleCount:"?"}))}}catch(t){console.error("Error getting source files:",t)}return t.style.length>0&&n.push({url:"element.style (inline)",ruleCount:t.style.length}),n}(r.currentElement);if(r.sourceFiles=n,0===n.length)return void(t.innerHTML='<p style="padding: 20px; color: #9ca3af;">No CSS sources found</p>');let e='<div style="padding: 10px;">';n.forEach(({url:t,ruleCount:n})=>{e+=`\n        <div style="margin-bottom: 12px; padding: 10px; background: #111827; border-radius: 4px;">\n          <div style="color: #60a5fa; font-size: 12px; margin-bottom: 4px; word-break: break-all;">${t}</div>\n          <div style="color: #9ca3af; font-size: 11px;">${n} ${1===n?"rule":"rules"}</div>\n        </div>\n      `}),e+="</div>",t.innerHTML=e}function w(){const t=r.inspectorBlock.querySelector(".css-editor"),n=r.inspectorBlock.querySelector(".editor-highlight");let e="";if(r.settings.includeChildren)e=d(r.currentElement);else{const t=i(r.currentElement,r.settings.selectorMode);let n="";r.displayedCSS.forEach(({prop:t,value:e})=>{n+=`  ${t}: ${e};\n`}),e=`${t} {\n${n}}`}r.originalCSS=e,t.value=e,n&&(n.innerHTML=p(e))}function C(){let t="";if(r.settings.includeChildren){t=r.inspectorBlock.querySelector(".css-code").textContent}else{let n="";r.displayedCSS.forEach(({prop:t,value:e})=>{n+=`  ${t}: ${e};\n`});t=`${i(r.currentElement,r.settings.selectorMode)} {\n${n}}`}if(r.settings.copyHTMLWithCSS){m(`${u(r.currentElement,r.settings.includeChildren)}\n\n<style>\n${t}\n</style>`,"HTML + CSS copied!")}else m(t,r.settings.includeChildren?"CSS with children copied!":"CSS copied!")}function E(t){if(!t||t===document.documentElement)return;r.currentElement=t;const n=t.getBoundingClientRect();r.overlay.style.top=`${n.top+window.scrollY}px`,r.overlay.style.left=`${n.left+window.scrollX}px`,r.overlay.style.width=`${n.width}px`,r.overlay.style.height=`${n.height}px`;const e=t.tagName.toLowerCase(),o=t.id?`#${t.id}`:"",i=t.classList.length>0?`.${Array.from(t.classList).join(".")}`:"",a=`${Math.round(n.width)}×${Math.round(n.height)}`;r.inspectorBlock.querySelector(".element-tag").textContent=`<${e}${o}${i}>`,r.inspectorBlock.querySelector(".element-size").textContent=a,function(t){const n=r.inspectorBlock.querySelector(".inspector-breadcrumb"),e=[],o=[];let i=t;function a(t,n=15){return t.length<=n?t:t.substring(0,n)+"..."}for(;i&&i!==document.body;){const t=i.tagName.toLowerCase(),n=i.id?`#${i.id}`:"",r=`${t}${n}${i.classList.length>0?`.${i.classList[0]}`:""}`;o.unshift(r);const s=`${t}${n}${i.classList.length>0?`.${a(i.classList[0])}`:""}`;e.unshift(s),i=i.parentElement}const s=r.settings.maxBreadcrumbDepth||0,c=s>0&&e.length>s,l=c?e.slice(-s):e,p=c?o.slice(-s):o;let d="";c&&(d=`<span class="breadcrumb-ellipsis" title="Path truncated - showing last ${s} of ${e.length} levels">...</span> › `);d+=l.map((t,n)=>{const o=p[n],r=o!==t?o:"";return`<span class="breadcrumb-item" data-index="${c?n+(e.length-s):n}" ${r?`title="${r}"`:""}>${t}</span>`}).join(" › "),n.innerHTML=d,n.querySelectorAll(".breadcrumb-item").forEach(n=>{n.addEventListener("click",e=>{e.stopPropagation();const r=parseInt(n.getAttribute("data-index"));let i=t;const a=o.length-1-r;for(let t=0;t<a;t++)i=i.parentElement;E(i)})})}(t),x(r.currentTab),r.frozen||function(t){const n=r.inspectorBlock,e=600,o=500;let i=t.left+t.width+20,a=t.top;i+e>window.innerWidth-10&&(i=t.left-e-20);i<10&&(i=10);a+o>window.innerHeight-10&&(a=window.innerHeight-o-10);a<10&&(a=10);n.style.left=`${i}px`,n.style.top=`${a}px`}(n)}function L(){r.frozen=!r.frozen,r.frozen?(r.inspectorBlock.style.borderColor="#ffd43b",r.overlay.style.borderColor="#ffd43b",g("Frozen - Space to unfreeze")):(r.inspectorBlock.style.borderColor="#3b82f6",r.overlay.style.borderColor="#3b82f6",g("Unfrozen")),z()}function z(){r.inspectorBlock.querySelector(".inspector-footer span").textContent=`${o("footerSpace")} ${o("footerTo")} ${r.frozen?o("footerUnfreeze"):o("footerFreeze")} • ${o("footerBackspace")} ${o("footerTo")} ${r.frozen?o("footerFreeze"):o("footerUnfreeze")} • ${o("footerEsc")} ${o("footerTo")} ${o("footerClose")}`}function q(t){r.frozen||r.active&&(t.target.closest("#css-scanner-block")||t.target.closest("#css-scanner-overlay")||t.target.closest("#css-scanner-options")||t.target.closest("#css-scanner-guide-overlay")||E(t.target))}function T(t){r.active&&(t.target.closest("#css-scanner-block")||t.target.closest("#css-scanner-options")||t.target.closest("#css-scanner-guide-overlay")||(t.preventDefault(),t.stopPropagation(),r.settings.copyOnClick&&C()))}function P(t){r.active&&(" "===t.key&&(t.preventDefault(),r.settings.pinOnSpace&&L()),"Backspace"===t.key&&(t.preventDefault(),r.frozen=!r.frozen,r.frozen?(r.inspectorBlock.style.borderColor="#ffd43b",r.overlay.style.borderColor="#ffd43b"):(r.inspectorBlock.style.borderColor="#3b82f6",r.overlay.style.borderColor="#3b82f6"),z()),"Escape"===t.key&&(t.preventDefault(),M()),"ArrowUp"===t.key&&(t.preventDefault(),r.currentElement&&r.currentElement.parentElement&&E(r.currentElement.parentElement)),"ArrowDown"===t.key&&(t.preventDefault(),r.currentElement&&r.currentElement.firstElementChild&&E(r.currentElement.firstElementChild)))}function B(){r.active||(r.active=!0,async function(){if("undefined"!=typeof chrome&&chrome.storage)chrome.storage.sync.get(["cssScanner"],async t=>{t.cssScanner&&(Object.assign(r.settings,t.cssScanner),r.settings.language&&"auto"!==r.settings.language&&(n=r.settings.language,await e(n)))});else{const t=localStorage.getItem("cssScanner");if(t)try{Object.assign(r.settings,JSON.parse(t)),r.settings.language&&"auto"!==r.settings.language&&(n=r.settings.language,await e(n))}catch(t){console.error("Failed to load settings:",t)}}}(),r.overlay=function(){const t=document.createElement("div");return t.id="css-scanner-overlay",t.style.cssText="\n      position: absolute !important;\n      pointer-events: none !important;\n      border: 2px solid #3b82f6 !important;\n      background: rgba(59, 130, 246, 0.1) !important;\n      z-index: 2147483646 !important;\n      transition: all 0.1s ease !important;\n    ",document.body.appendChild(t),t}(),r.inspectorBlock=h(),document.addEventListener("mousemove",q,!0),document.addEventListener("click",T,!0),document.addEventListener("keydown",P,!0),g(o("notificationActivated")))}function M(){r.active&&(r.active=!1,r.frozen=!1,document.removeEventListener("mousemove",q,!0),document.removeEventListener("click",T,!0),document.removeEventListener("keydown",P,!0),r.overlay&&(r.overlay.remove(),r.overlay=null),r.inspectorBlock&&(r.inspectorBlock.remove(),r.inspectorBlock=null),r.optionsPanel&&(r.optionsPanel.remove(),r.optionsPanel=null),b(),g(o("notificationDeactivated")))}chrome.runtime.onMessage.addListener((t,n,e)=>{"TOGGLE_SCANNER"===t.type&&(r.active?M():B())}),r.active||B()}();